

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>CUtils module &mdash; Orb 1.6.1 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/logo.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/sphinx_paramlinks.css" type="text/css" />
  

  
    <link rel="top" title="Orb 1.6.1 documentation" href="index.html"/>
        <link rel="next" title="Astrometry module" href="astrometry_module.html"/>
        <link rel="prev" title="Utils module" href="utils_module.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Orb
          

          
            
            <img src="_static/logo_sidebar.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.6.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="installing_orb.html">Installing Orb</a></li>
<li class="toctree-l1"><a class="reference internal" href="installing_python.html">Installing Python</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="python_for_orb.html">Python for ORB users</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_analysis_with_orb.html">Data analysis with ORB</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core_module.html">Core module</a></li>
<li class="toctree-l1"><a class="reference internal" href="utils_module.html">Utils module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">CUtils module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#contents">Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-cutils">Cutils</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="astrometry_module.html">Astrometry module</a></li>
<li class="toctree-l1"><a class="reference internal" href="viewer_module.html">Viewer module</a></li>
<li class="toctree-l1"><a class="reference internal" href="fit_module.html">Fit module</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_module.html">Data module</a></li>
<li class="toctree-l1"><a class="reference internal" href="constants_module.html">Constants module</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Orb</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>CUtils module</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/cutils_module.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="cutils-module">
<h1>CUtils module<a class="headerlink" href="#cutils-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="contents">
<h2>Contents<a class="headerlink" href="#contents" title="Permalink to this headline">¶</a></h2>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#cutils.radians" title="cutils.radians"><code class="xref py py-obj docutils literal"><span class="pre">cutils.radians</span></code></a></td>
<td>Convert degrees to radians</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.transform_B_to_A" title="cutils.transform_B_to_A"><code class="xref py py-obj docutils literal"><span class="pre">cutils.transform_B_to_A</span></code></a></td>
<td>Transform star positions in camera B to the same star position    in camera A given the transformation parameters.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.transform_A_to_B" title="cutils.transform_A_to_B"><code class="xref py py-obj docutils literal"><span class="pre">cutils.transform_A_to_B</span></code></a></td>
<td>Transform star positions in camera A to the same star position</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.sip_im2pix" title="cutils.sip_im2pix"><code class="xref py py-obj docutils literal"><span class="pre">cutils.sip_im2pix</span></code></a></td>
<td>Transform perfect pixel positions to distorded pixels positions</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.sip_pix2im" title="cutils.sip_pix2im"><code class="xref py py-obj docutils literal"><span class="pre">cutils.sip_pix2im</span></code></a></td>
<td>Transform distorded pixel positions to perfect pixels positions</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.create_transform_maps" title="cutils.create_transform_maps"><code class="xref py py-obj docutils literal"><span class="pre">cutils.create_transform_maps</span></code></a></td>
<td>Create the 2 transformation maps used to compute the geometrical transformation.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.gaussian_array2d" title="cutils.gaussian_array2d"><code class="xref py py-obj docutils literal"><span class="pre">cutils.gaussian_array2d</span></code></a></td>
<td>Return the 2D profile of a gaussian</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.moffat_array2d" title="cutils.moffat_array2d"><code class="xref py py-obj docutils literal"><span class="pre">cutils.moffat_array2d</span></code></a></td>
<td>Return the 2D profile of a moffat</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.surface_value" title="cutils.surface_value"><code class="xref py py-obj docutils literal"><span class="pre">cutils.surface_value</span></code></a></td>
<td>Return an approximation of the surface value of a pixel given the min and max radius of an annulus in pixels.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.sigmacut" title="cutils.sigmacut"><code class="xref py py-obj docutils literal"><span class="pre">cutils.sigmacut</span></code></a></td>
<td>Return a distribution after a sigma cut rejection of the too deviant values.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.meansigcut2d" title="cutils.meansigcut2d"><code class="xref py py-obj docutils literal"><span class="pre">cutils.meansigcut2d</span></code></a></td>
<td>Return the sigma cut mean of a 2d array along a given axis.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.sigmaclip" title="cutils.sigmaclip"><code class="xref py py-obj docutils literal"><span class="pre">cutils.sigmaclip</span></code></a></td>
<td>Return a distribution after a sigma clipping rejection of the too deviant values.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.master_combine" title="cutils.master_combine"><code class="xref py py-obj docutils literal"><span class="pre">cutils.master_combine</span></code></a></td>
<td>Create a master frame from a set a frames.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils._robust_format" title="cutils._robust_format"><code class="xref py py-obj docutils literal"><span class="pre">cutils._robust_format</span></code></a></td>
<td>Format data and check if it can be computed by bottleneck module.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.robust_mean" title="cutils.robust_mean"><code class="xref py py-obj docutils literal"><span class="pre">cutils.robust_mean</span></code></a></td>
<td>Compute robust mean of a numpy ndarray (NaNs are skipped)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.robust_median" title="cutils.robust_median"><code class="xref py py-obj docutils literal"><span class="pre">cutils.robust_median</span></code></a></td>
<td>Compute robust median of a numpy ndarray (NaNs are skipped)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.robust_sum" title="cutils.robust_sum"><code class="xref py py-obj docutils literal"><span class="pre">cutils.robust_sum</span></code></a></td>
<td>Compute robust sum of a numpy ndarray (NaNs are skipped)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.robust_std" title="cutils.robust_std"><code class="xref py py-obj docutils literal"><span class="pre">cutils.robust_std</span></code></a></td>
<td>Compute robust std of a numpy ndarray (NaNs are skipped)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.robust_average" title="cutils.robust_average"><code class="xref py py-obj docutils literal"><span class="pre">cutils.robust_average</span></code></a></td>
<td>Compute robust average of a numpy ndarray (NaNs are skipped)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.gaussian1d" title="cutils.gaussian1d"><code class="xref py py-obj docutils literal"><span class="pre">cutils.gaussian1d</span></code></a></td>
<td>Return a 1D gaussian given a set of parameters.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.sinc1d" title="cutils.sinc1d"><code class="xref py py-obj docutils literal"><span class="pre">cutils.sinc1d</span></code></a></td>
<td>Return a 1D sinc given a set of parameters.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.sincgauss1d" title="cutils.sincgauss1d"><code class="xref py py-obj docutils literal"><span class="pre">cutils.sincgauss1d</span></code></a></td>
<td>Return a 1D sinc convoluted with a gaussian of parameter sigma.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.interf_mean_energy" title="cutils.interf_mean_energy"><code class="xref py py-obj docutils literal"><span class="pre">cutils.interf_mean_energy</span></code></a></td>
<td>Return the mean energy of an interferogram by step.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.spectrum_mean_energy" title="cutils.spectrum_mean_energy"><code class="xref py py-obj docutils literal"><span class="pre">cutils.spectrum_mean_energy</span></code></a></td>
<td>Return the mean energy of a spectrum by channel.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.fft_filter" title="cutils.fft_filter"><code class="xref py py-obj docutils literal"><span class="pre">cutils.fft_filter</span></code></a></td>
<td>Simple lowpass or highpass FFT filter (high pass or low pass)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.low_pass_image_filter" title="cutils.low_pass_image_filter"><code class="xref py py-obj docutils literal"><span class="pre">cutils.low_pass_image_filter</span></code></a></td>
<td>Low pass image filter by convolution with a gaussian kernel.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.fast_gaussian_kernel" title="cutils.fast_gaussian_kernel"><code class="xref py py-obj docutils literal"><span class="pre">cutils.fast_gaussian_kernel</span></code></a></td>
<td>Return a fast gaussian kernel.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.gaussian_kernel" title="cutils.gaussian_kernel"><code class="xref py py-obj docutils literal"><span class="pre">cutils.gaussian_kernel</span></code></a></td>
<td>Return a gaussian kernel.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.get_box_coords" title="cutils.get_box_coords"><code class="xref py py-obj docutils literal"><span class="pre">cutils.get_box_coords</span></code></a></td>
<td>Return the coordinates of a box given the center of the box, its size and the limits of the range along x and y axes.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.point_inside_polygon" title="cutils.point_inside_polygon"><code class="xref py py-obj docutils literal"><span class="pre">cutils.point_inside_polygon</span></code></a></td>
<td>Determine if a point is inside a given polygon or not Polygon is a list of (x,y) pairs.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.multi_fit_stars" title="cutils.multi_fit_stars"><code class="xref py py-obj docutils literal"><span class="pre">cutils.multi_fit_stars</span></code></a></td>
<td>Fit multiple stars at the same time.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.part_value" title="cutils.part_value"><code class="xref py py-obj docutils literal"><span class="pre">cutils.part_value</span></code></a></td>
<td>Return the value lying between two parts of a partition</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.indft" title="cutils.indft"><code class="xref py py-obj docutils literal"><span class="pre">cutils.indft</span></code></a></td>
<td>Inverse Non-uniform Discret Fourier Transform.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.map_me" title="cutils.map_me"><code class="xref py py-obj docutils literal"><span class="pre">cutils.map_me</span></code></a></td>
<td>Create a map of the modulation efficiency from a laser frame.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.nanbin_image" title="cutils.nanbin_image"><code class="xref py py-obj docutils literal"><span class="pre">cutils.nanbin_image</span></code></a></td>
<td>Mean image binning robust to NaNs.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.unbin_image" title="cutils.unbin_image"><code class="xref py py-obj docutils literal"><span class="pre">cutils.unbin_image</span></code></a></td>
<td>Unbin a binned image (restore the image binned with the function <code class="xref py py-func docutils literal"><span class="pre">nanbin_image()</span></code>).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.im2rgba" title="cutils.im2rgba"><code class="xref py py-obj docutils literal"><span class="pre">cutils.im2rgba</span></code></a></td>
<td>Compute RGBA from image given a matplotlib colorbar instance.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.detect_cosmic_rays" title="cutils.detect_cosmic_rays"><code class="xref py py-obj docutils literal"><span class="pre">cutils.detect_cosmic_rays</span></code></a></td>
<td>Check if a given pixel is a cosmic ray (classic detection).</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.check_cosmic_rays_neighbourhood" title="cutils.check_cosmic_rays_neighbourhood"><code class="xref py py-obj docutils literal"><span class="pre">cutils.check_cosmic_rays_neighbourhood</span></code></a></td>
<td>Check the neighbourhood around detected cosmic rays in a frame.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.fast_w2pix" title="cutils.fast_w2pix"><code class="xref py py-obj docutils literal"><span class="pre">cutils.fast_w2pix</span></code></a></td>
<td>Fast conversion of wavelength/wavenumber to pixel</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.fast_pix2w" title="cutils.fast_pix2w"><code class="xref py py-obj docutils literal"><span class="pre">cutils.fast_pix2w</span></code></a></td>
<td>Fast conversion of pixel to wavelength/wavenumber</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.get_cm1_axis_min" title="cutils.get_cm1_axis_min"><code class="xref py py-obj docutils literal"><span class="pre">cutils.get_cm1_axis_min</span></code></a></td>
<td>Return min wavenumber of a regular wavenumber axis in cm-1.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.get_cm1_axis_max" title="cutils.get_cm1_axis_max"><code class="xref py py-obj docutils literal"><span class="pre">cutils.get_cm1_axis_max</span></code></a></td>
<td>Return max wavenumber of a regular wavenumber axis in cm-1.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.get_cm1_axis_step" title="cutils.get_cm1_axis_step"><code class="xref py py-obj docutils literal"><span class="pre">cutils.get_cm1_axis_step</span></code></a></td>
<td>Return step size of a regular wavenumber axis in cm-1.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.get_nm_axis_min" title="cutils.get_nm_axis_min"><code class="xref py py-obj docutils literal"><span class="pre">cutils.get_nm_axis_min</span></code></a></td>
<td>Return min wavelength of regular wavelength axis in nm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.get_nm_axis_max" title="cutils.get_nm_axis_max"><code class="xref py py-obj docutils literal"><span class="pre">cutils.get_nm_axis_max</span></code></a></td>
<td>Return max wavelength of regular wavelength axis in nm.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#cutils.get_nm_axis_step" title="cutils.get_nm_axis_step"><code class="xref py py-obj docutils literal"><span class="pre">cutils.get_nm_axis_step</span></code></a></td>
<td>Return step size of a regular wavelength axis in nm.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#cutils.compute_radial_velocity" title="cutils.compute_radial_velocity"><code class="xref py py-obj docutils literal"><span class="pre">cutils.compute_radial_velocity</span></code></a></td>
<td>Return radial velocity in km.s-1</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="module-cutils">
<span id="cutils"></span><h2>Cutils<a class="headerlink" href="#module-cutils" title="Permalink to this headline">¶</a></h2>
<p>CUtils is a set of C functions coded in <a class="reference external" href="http://cython.org/">Cython</a> to improve their speed.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>This file must be compiled before it can be used:</p>
<p>cython cutils.pyx</p>
<p>gcc -c -fPIC -I/usr/include/python2.7 cutils.c</p>
<p class="last">gcc -shared cutils.o -o cutils.so</p>
</div>
<dl class="function">
<dt id="cutils.radians">
<code class="descclassname">cutils.</code><code class="descname">radians</code><span class="sig-paren">(</span><em>double deg</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.radians" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert degrees to radians</p>
</dd></dl>

<dl class="function">
<dt id="cutils.transform_B_to_A">
<code class="descclassname">cutils.</code><code class="descname">transform_B_to_A</code><span class="sig-paren">(</span><em>double x1</em>, <em>double y1</em>, <em>double dx</em>, <em>double dy</em>, <em>double dr</em>, <em>double da</em>, <em>double db</em>, <em>double xrc</em>, <em>double yrc</em>, <em>double zx</em>, <em>double zy</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.transform_B_to_A" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Transform star positions in camera B to the same star position</dt>
<dd>in camera A given the transformation parameters.</dd>
</dl>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">this function is meant to be the inverse of
transform_A_to_B. Given the output of transform_A_to_B and the
<strong>SAME transformation parameters</strong> the initial positions must be
returned by this function within the numerical error. i.e. if
(Xb, Yb) = A_to_B(Xi,Yi,p) and (Xa, Ya) = B_to_A(Xb, Yb, p) then
Xa - Xi ~ 1e-13 and Ya - Yi ~ 1e-13 (for float64 numbers)</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.transform_B_to_A.params.x1"></span><strong>x1</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.x1">¶</a> &#8211; x coordinate to transform</li>
<li><span class="target" id="cutils.transform_B_to_A.params.y1"></span><strong>y1</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.y1">¶</a> &#8211; y coordinate to transform</li>
<li><span class="target" id="cutils.transform_B_to_A.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.dx">¶</a> &#8211; translation along x</li>
<li><span class="target" id="cutils.transform_B_to_A.params.dy"></span><strong>dy</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.dy">¶</a> &#8211; translation along y</li>
<li><span class="target" id="cutils.transform_B_to_A.params.dr"></span><strong>dr</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.dr">¶</a> &#8211; rotation in the plane of the image</li>
<li><span class="target" id="cutils.transform_B_to_A.params.da"></span><strong>da</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.da">¶</a> &#8211; tip angle</li>
<li><span class="target" id="cutils.transform_B_to_A.params.db"></span><strong>db</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.db">¶</a> &#8211; tilt angle</li>
<li><span class="target" id="cutils.transform_B_to_A.params.xrc"></span><strong>xrc</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.xrc">¶</a> &#8211; x coordinate of the rotation center</li>
<li><span class="target" id="cutils.transform_B_to_A.params.yrc"></span><strong>yrc</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.yrc">¶</a> &#8211; y coordinate of the rotation center</li>
<li><span class="target" id="cutils.transform_B_to_A.params.zx"></span><strong>zx</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.zx">¶</a> &#8211; zoom coefficient along x</li>
<li><span class="target" id="cutils.transform_B_to_A.params.zy"></span><strong>zy</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_B_to_A.params.zy">¶</a> &#8211; zoom coefficient along y</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.transform_A_to_B">
<code class="descclassname">cutils.</code><code class="descname">transform_A_to_B</code><span class="sig-paren">(</span><em>double x1</em>, <em>double y1</em>, <em>double dx</em>, <em>double dy</em>, <em>double dr</em>, <em>double da</em>, <em>double db</em>, <em>double xrc</em>, <em>double yrc</em>, <em>double zx</em>, <em>double zy</em>, <em>double x1_err=0.0</em>, <em>double y1_err=0.0</em>, <em>double dx_err=0.0</em>, <em>double dy_err=0.0</em>, <em>double dr_err=0.0</em>, <em>double zx_err=0.0</em>, <em>double zy_err=0.0</em>, <em>bool return_err=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.transform_A_to_B" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform star positions in camera A to the same star position
in camera B given the transformation parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="cutils.transform_A_to_B.params.x1"></span><strong>x1</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.x1">¶</a> &#8211; x coordinate to transform</li>
<li><span class="target" id="cutils.transform_A_to_B.params.y1"></span><strong>y1</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.y1">¶</a> &#8211; y coordinate to transform</li>
<li><span class="target" id="cutils.transform_A_to_B.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.dx">¶</a> &#8211; translation along x</li>
<li><span class="target" id="cutils.transform_A_to_B.params.dy"></span><strong>dy</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.dy">¶</a> &#8211; translation along y</li>
<li><span class="target" id="cutils.transform_A_to_B.params.dr"></span><strong>dr</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.dr">¶</a> &#8211; rotation in the plane of the image</li>
<li><span class="target" id="cutils.transform_A_to_B.params.da"></span><strong>da</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.da">¶</a> &#8211; tip angle</li>
<li><span class="target" id="cutils.transform_A_to_B.params.db"></span><strong>db</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.db">¶</a> &#8211; tilt angle</li>
<li><span class="target" id="cutils.transform_A_to_B.params.xrc"></span><strong>xrc</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.xrc">¶</a> &#8211; x coordinate of the rotation center</li>
<li><span class="target" id="cutils.transform_A_to_B.params.yrc"></span><strong>yrc</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.yrc">¶</a> &#8211; y coordinate of the rotation center</li>
<li><span class="target" id="cutils.transform_A_to_B.params.zx"></span><strong>zx</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.zx">¶</a> &#8211; zoom coefficient along x</li>
<li><span class="target" id="cutils.transform_A_to_B.params.zy"></span><strong>zy</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.zy">¶</a> &#8211; zoom coefficient along y</li>
<li><span class="target" id="cutils.transform_A_to_B.params.x1_err"></span><strong>x1_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.x1_err">¶</a> &#8211; (Optional) Error on x1 estimate (default 0.)</li>
<li><span class="target" id="cutils.transform_A_to_B.params.y1_err"></span><strong>y1_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.y1_err">¶</a> &#8211; (Optional) Error on y1 estimate (default 0.)</li>
<li><span class="target" id="cutils.transform_A_to_B.params.dx_err"></span><strong>dx_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.dx_err">¶</a> &#8211; (Optional) Error on dx estimate (default 0.)</li>
<li><span class="target" id="cutils.transform_A_to_B.params.dy_err"></span><strong>dy_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.dy_err">¶</a> &#8211; (Optional) Error on dy estimate (default 0.)</li>
<li><span class="target" id="cutils.transform_A_to_B.params.dr_err"></span><strong>dr_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.dr_err">¶</a> &#8211; (Optional) Error on dr estimate (default 0.)</li>
<li><span class="target" id="cutils.transform_A_to_B.params.zx_err"></span><strong>zx_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.zx_err">¶</a> &#8211; (Optional) Error on zx estimate (default 0.)</li>
<li><span class="target" id="cutils.transform_A_to_B.params.zy_err"></span><strong>zy_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.zy_err">¶</a> &#8211; (Optional) Error on zy estimate (default 0.)</li>
<li><span class="target" id="cutils.transform_A_to_B.params.return_err"></span><strong>return_err</strong><a class="paramlink headerlink reference internal" href="#cutils.transform_A_to_B.params.return_err">¶</a> &#8211; (Optional) If True, the error on the estimate
of x2 and y2 is returned.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(x2, y2) = f(x1, y1). (x2, y2, x2_err, y2_err) if
return_err is True.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.sip_im2pix">
<code class="descclassname">cutils.</code><code class="descname">sip_im2pix</code><span class="sig-paren">(</span><em>ndarray im_coords</em>, <em>sip</em>, <em>tolerance=1e-08</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.sip_im2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform perfect pixel positions to distorded pixels positions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.sip_im2pix.params.im_coords"></span><strong>im_coords</strong><a class="paramlink headerlink reference internal" href="#cutils.sip_im2pix.params.im_coords">¶</a> &#8211; perfect pixel positions as an Nx2 array of floats.</li>
<li><span class="target" id="cutils.sip_im2pix.params.sip"></span><strong>sip</strong><a class="paramlink headerlink reference internal" href="#cutils.sip_im2pix.params.sip">¶</a> &#8211; pywcs.WCS() instance containing SIP parameters.</li>
<li><span class="target" id="cutils.sip_im2pix.params.tolerance"></span><strong>tolerance</strong><a class="paramlink headerlink reference internal" href="#cutils.sip_im2pix.params.tolerance">¶</a> &#8211; tolerance on the iterative method.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.sip_pix2im">
<code class="descclassname">cutils.</code><code class="descname">sip_pix2im</code><span class="sig-paren">(</span><em>ndarray pix_coords</em>, <em>sip</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.sip_pix2im" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform distorded pixel positions to perfect pixels positions</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.sip_pix2im.params.pix_coords"></span><strong>pix_coords</strong><a class="paramlink headerlink reference internal" href="#cutils.sip_pix2im.params.pix_coords">¶</a> &#8211; distorded pixel positions as an Nx2 array of floats.</li>
<li><span class="target" id="cutils.sip_pix2im.params.sip"></span><strong>sip</strong><a class="paramlink headerlink reference internal" href="#cutils.sip_pix2im.params.sip">¶</a> &#8211; pywcs.WCS() instance containing SIP parameters.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.create_transform_maps">
<code class="descclassname">cutils.</code><code class="descname">create_transform_maps</code><span class="sig-paren">(</span><em>int nx</em>, <em>int ny</em>, <em>double dx</em>, <em>double dy</em>, <em>double dr</em>, <em>double da</em>, <em>double db</em>, <em>double xrc</em>, <em>double yrc</em>, <em>double zx</em>, <em>double zy</em>, <em>sip_A</em>, <em>sip_B</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.create_transform_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Create the 2 transformation maps used to compute the
geometrical transformation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.create_transform_maps.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.nx">¶</a> &#8211; size of the frame along x axis</li>
<li><span class="target" id="cutils.create_transform_maps.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.ny">¶</a> &#8211; size of the frame along y axis</li>
<li><span class="target" id="cutils.create_transform_maps.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.dx">¶</a> &#8211; translation along x</li>
<li><span class="target" id="cutils.create_transform_maps.params.dy"></span><strong>dy</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.dy">¶</a> &#8211; translation along y</li>
<li><span class="target" id="cutils.create_transform_maps.params.dr"></span><strong>dr</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.dr">¶</a> &#8211; rotation in the plane of the image</li>
<li><span class="target" id="cutils.create_transform_maps.params.da"></span><strong>da</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.da">¶</a> &#8211; tip angle</li>
<li><span class="target" id="cutils.create_transform_maps.params.db"></span><strong>db</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.db">¶</a> &#8211; tilt angle</li>
<li><span class="target" id="cutils.create_transform_maps.params.xrc"></span><strong>xrc</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.xrc">¶</a> &#8211; x coordinate of the rotation center</li>
<li><span class="target" id="cutils.create_transform_maps.params.yrc"></span><strong>yrc</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.yrc">¶</a> &#8211; y coordinate of the rotation center</li>
<li><span class="target" id="cutils.create_transform_maps.params.zx"></span><strong>zx</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.zx">¶</a> &#8211; zoom coefficient along x</li>
<li><span class="target" id="cutils.create_transform_maps.params.zy"></span><strong>zy</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.zy">¶</a> &#8211; zoom coefficient along y</li>
<li><span class="target" id="cutils.create_transform_maps.params.sip_A"></span><strong>sip_A</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.sip_A">¶</a> &#8211; pywcs.WCS() instance containing SIP parameters of
the output image.</li>
<li><span class="target" id="cutils.create_transform_maps.params.sip_B"></span><strong>sip_B</strong><a class="paramlink headerlink reference internal" href="#cutils.create_transform_maps.params.sip_B">¶</a> &#8211; pywcs.WCS() instance containing SIP parameters of
the input image.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.gaussian_array2d">
<code class="descclassname">cutils.</code><code class="descname">gaussian_array2d</code><span class="sig-paren">(</span><em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double dy</em>, <em>double fwhm</em>, <em>int nx</em>, <em>int ny</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.gaussian_array2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the 2D profile of a gaussian</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.gaussian_array2d.params.h"></span><strong>h</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_array2d.params.h">¶</a> &#8211; Height</li>
<li><span class="target" id="cutils.gaussian_array2d.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_array2d.params.a">¶</a> &#8211; Amplitude</li>
<li><span class="target" id="cutils.gaussian_array2d.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_array2d.params.dx">¶</a> &#8211; X position</li>
<li><span class="target" id="cutils.gaussian_array2d.params.dy"></span><strong>dy</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_array2d.params.dy">¶</a> &#8211; Y position</li>
<li><span class="target" id="cutils.gaussian_array2d.params.fwhm"></span><strong>fwhm</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_array2d.params.fwhm">¶</a> &#8211; FWHM</li>
<li><span class="target" id="cutils.gaussian_array2d.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_array2d.params.nx">¶</a> &#8211; X dimension of the output array</li>
<li><span class="target" id="cutils.gaussian_array2d.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_array2d.params.ny">¶</a> &#8211; Y dimension of the output array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.moffat_array2d">
<code class="descclassname">cutils.</code><code class="descname">moffat_array2d</code><span class="sig-paren">(</span><em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double dy</em>, <em>double fwhm</em>, <em>double beta</em>, <em>int nx</em>, <em>int ny</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.moffat_array2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the 2D profile of a moffat</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.moffat_array2d.params.h"></span><strong>h</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.h">¶</a> &#8211; Height</li>
<li><span class="target" id="cutils.moffat_array2d.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.a">¶</a> &#8211; Amplitude</li>
<li><span class="target" id="cutils.moffat_array2d.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.dx">¶</a> &#8211; X position</li>
<li><span class="target" id="cutils.moffat_array2d.params.dy"></span><strong>dy</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.dy">¶</a> &#8211; Y position</li>
<li><span class="target" id="cutils.moffat_array2d.params.fwhm"></span><strong>fwhm</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.fwhm">¶</a> &#8211; FWHM</li>
<li><span class="target" id="cutils.moffat_array2d.params.beta"></span><strong>beta</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.beta">¶</a> &#8211; Beta</li>
<li><span class="target" id="cutils.moffat_array2d.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.nx">¶</a> &#8211; X dimension of the output array</li>
<li><span class="target" id="cutils.moffat_array2d.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#cutils.moffat_array2d.params.ny">¶</a> &#8211; Y dimension of the output array</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.surface_value">
<code class="descclassname">cutils.</code><code class="descname">surface_value</code><span class="sig-paren">(</span><em>int dimx</em>, <em>int dimy</em>, <em>double xc</em>, <em>double yc</em>, <em>double rmin</em>, <em>double rmax</em>, <em>long sub_div</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.surface_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an approximation of the surface value of a pixel given
the min and max radius of an annulus in pixels.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.surface_value.params.dimx"></span><strong>dimx</strong><a class="paramlink headerlink reference internal" href="#cutils.surface_value.params.dimx">¶</a> &#8211; dimension of the box along x</li>
<li><span class="target" id="cutils.surface_value.params.dimy"></span><strong>dimy</strong><a class="paramlink headerlink reference internal" href="#cutils.surface_value.params.dimy">¶</a> &#8211; dimension of the box along y</li>
<li><span class="target" id="cutils.surface_value.params.xc"></span><strong>xc</strong><a class="paramlink headerlink reference internal" href="#cutils.surface_value.params.xc">¶</a> &#8211; center of the annulus along x</li>
<li><span class="target" id="cutils.surface_value.params.yc"></span><strong>yc</strong><a class="paramlink headerlink reference internal" href="#cutils.surface_value.params.yc">¶</a> &#8211; center of the annulus along y</li>
<li><span class="target" id="cutils.surface_value.params.rmin"></span><strong>rmin</strong><a class="paramlink headerlink reference internal" href="#cutils.surface_value.params.rmin">¶</a> &#8211; min radius of the annulus</li>
<li><span class="target" id="cutils.surface_value.params.rmax"></span><strong>rmax</strong><a class="paramlink headerlink reference internal" href="#cutils.surface_value.params.rmax">¶</a> &#8211; max radius of the annulus</li>
<li><span class="target" id="cutils.surface_value.params.sub_div"></span><strong>sub_div</strong><a class="paramlink headerlink reference internal" href="#cutils.surface_value.params.sub_div">¶</a> &#8211; Number of subdivisions to make (the higher,the
better but the longer too)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.sigmacut">
<code class="descclassname">cutils.</code><code class="descname">sigmacut</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double central_value</em>, <em>int use_central_value</em>, <em>double sigma</em>, <em>int min_values</em>, <em>return_index_list=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.sigmacut" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution after a sigma cut rejection
of the too deviant values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.sigmacut.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmacut.params.x">¶</a> &#8211; The distribution to cut</li>
<li><span class="target" id="cutils.sigmacut.params.sigma"></span><strong>sigma</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmacut.params.sigma">¶</a> &#8211; Number of sigma above which values are considered as
deviant</li>
<li><span class="target" id="cutils.sigmacut.params.min_values"></span><strong>min_values</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmacut.params.min_values">¶</a> &#8211; Minimum number of values to return</li>
<li><span class="target" id="cutils.sigmacut.params.central_value"></span><strong>central_value</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmacut.params.central_value">¶</a> &#8211; If not none, this value is used as the
central value of the cut. Else the median of the distribution is
used as the central value</li>
<li><span class="target" id="cutils.sigmacut.params.use_central_value"></span><strong>use_central_value</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmacut.params.use_central_value">¶</a> &#8211; If True central value is used instead of
the median.</li>
<li><span class="target" id="cutils.sigmacut.params.return_index_list"></span><strong>return_index_list</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmacut.params.return_index_list">¶</a> &#8211; (Optional) If True the list of the non
rejected values is returned also (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.meansigcut2d">
<code class="descclassname">cutils.</code><code class="descname">meansigcut2d</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double sigma=3</em>, <em>int min_values=3</em>, <em>int axis=0</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.meansigcut2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the sigma cut mean of a 2d array along a given axis.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.meansigcut2d.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.meansigcut2d.params.x">¶</a> &#8211; The 2d array</li>
<li><span class="target" id="cutils.meansigcut2d.params.sigma"></span><strong>sigma</strong><a class="paramlink headerlink reference internal" href="#cutils.meansigcut2d.params.sigma">¶</a> &#8211; Number of sigma above which values are considered as
deviant</li>
<li><span class="target" id="cutils.meansigcut2d.params.min_values"></span><strong>min_values</strong><a class="paramlink headerlink reference internal" href="#cutils.meansigcut2d.params.min_values">¶</a> &#8211; Minimum number of values to return</li>
<li><span class="target" id="cutils.meansigcut2d.params.axis"></span><strong>axis</strong><a class="paramlink headerlink reference internal" href="#cutils.meansigcut2d.params.axis">¶</a> &#8211; Axis number. Must be 0 or 1.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.sigmaclip">
<code class="descclassname">cutils.</code><code class="descname">sigmaclip</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double sigma</em>, <em>int min_values</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.sigmaclip" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a distribution after a sigma clipping rejection
of the too deviant values.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.sigmaclip.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmaclip.params.x">¶</a> &#8211; The distribution to sigmaclip</li>
<li><span class="target" id="cutils.sigmaclip.params.sigma"></span><strong>sigma</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmaclip.params.sigma">¶</a> &#8211; Number of sigma above which values are considered as
deviant</li>
<li><span class="target" id="cutils.sigmaclip.params.min_values"></span><strong>min_values</strong><a class="paramlink headerlink reference internal" href="#cutils.sigmaclip.params.min_values">¶</a> &#8211; Minimum number of values to return</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.master_combine">
<code class="descclassname">cutils.</code><code class="descname">master_combine</code><span class="sig-paren">(</span><em>ndarray frames</em>, <em>double sigma</em>, <em>int nkeep</em>, <em>int combine_mode</em>, <em>int reject_mode</em>, <em>return_std_frame=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.master_combine" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a master frame from a set a frames.</p>
<p>This method has been inspired by the <strong>IRAF</strong> function
combine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.master_combine.params.frames"></span><strong>frames</strong><a class="paramlink headerlink reference internal" href="#cutils.master_combine.params.frames">¶</a> &#8211; Frames to be combined.</li>
<li><span class="target" id="cutils.master_combine.params.sigma"></span><strong>sigma</strong><a class="paramlink headerlink reference internal" href="#cutils.master_combine.params.sigma">¶</a> &#8211; Sigma factor for pixel rejection.</li>
<li><span class="target" id="cutils.master_combine.params.nkeep"></span><strong>nkeep</strong><a class="paramlink headerlink reference internal" href="#cutils.master_combine.params.nkeep">¶</a> &#8211; Minimum number of values to keep before
combining operation</li>
<li><span class="target" id="cutils.master_combine.params.combine_mode"></span><strong>combine_mode</strong><a class="paramlink headerlink reference internal" href="#cutils.master_combine.params.combine_mode">¶</a> &#8211; 0, mean ; 1, median.</li>
<li><span class="target" id="cutils.master_combine.params.reject_mode"></span><strong>reject_mode</strong><a class="paramlink headerlink reference internal" href="#cutils.master_combine.params.reject_mode">¶</a> &#8211; 0, avsigclip ; 1, sigclip ; 2, minmax.</li>
<li><span class="target" id="cutils.master_combine.params.return_std"></span><strong>return_std</strong><a class="paramlink headerlink reference internal" href="#cutils.master_combine.params.return_std">¶</a> &#8211; If True, the std frame is also returned
(default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Rejection operations:</p>
<ul class="last simple">
<li><strong>sigclip</strong>: A Sigma Clipping algorithm is applied for
each pixel. Min and max values are rejected to estimate
the mean and the standard deviation at each pixel. Then
all values over (median + sigma * std) or below (median -
sigma * std) are rejected. Those steps are repeated (this
time not excluding the extreme values) while no other
value is rejected or the minimum number of values to keep
is reached. Work best with at least 10 frames.</li>
<li><strong>avsigclip</strong>: Average Sigma Clipping algorithm is the
same as Sigma Clipping algorithm but the standard
deviation at each pixel is estimated using an averaged
value of the std over the lines. This work best than sigma
clipping for a small number of frames. This algorithm is a
little more time consuming than the others. Works best with
at least 5 frames.</li>
<li><strong>minmax</strong>: Minimum and maximum values at each pixel are
rejected.</li>
</ul>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">No rejection operation can be performed with less
than 3 frames.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="cutils._robust_format">
<code class="descclassname">cutils.</code><code class="descname">_robust_format</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils._robust_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Format data and check if it can be computed by bottleneck module.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils._robust_format.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils._robust_format.params.x">¶</a> &#8211; a numpy ndarray</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">(formatted_data, flag, complexflag). If the flag is True,
data can be computed by the bottleneck module. Else it must be
computed with Numpy. The complexflag tells if the data is
complex.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.robust_mean">
<code class="descclassname">cutils.</code><code class="descname">robust_mean</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.robust_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust mean of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.robust_mean.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.robust_mean.params.x">¶</a> &#8211; a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.robust_median">
<code class="descclassname">cutils.</code><code class="descname">robust_median</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.robust_median" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust median of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.robust_median.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.robust_median.params.x">¶</a> &#8211; a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.robust_sum">
<code class="descclassname">cutils.</code><code class="descname">robust_sum</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.robust_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust sum of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.robust_sum.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.robust_sum.params.x">¶</a> &#8211; a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.robust_std">
<code class="descclassname">cutils.</code><code class="descname">robust_std</code><span class="sig-paren">(</span><em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.robust_std" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust std of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.robust_std.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.robust_std.params.x">¶</a> &#8211; a numpy ndarray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.robust_average">
<code class="descclassname">cutils.</code><code class="descname">robust_average</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>ndarray w</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.robust_average" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute robust average of a numpy ndarray (NaNs are skipped)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.robust_average.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.robust_average.params.x">¶</a> &#8211; a numpy ndarray</li>
<li><span class="target" id="cutils.robust_average.params.w"></span><strong>w</strong><a class="paramlink headerlink reference internal" href="#cutils.robust_average.params.w">¶</a> &#8211; a numpy ndarray of weigths</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">To get a weighted average the MEAN of the weights must
be equal to 1.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="cutils.gaussian1d">
<code class="descclassname">cutils.</code><code class="descname">gaussian1d</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double fwhm</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.gaussian1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1D gaussian given a set of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.gaussian1d.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian1d.params.x">¶</a> &#8211; 1D array of float64 giving the positions where the
gaussian is evaluated</li>
<li><span class="target" id="cutils.gaussian1d.params.h"></span><strong>h</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian1d.params.h">¶</a> &#8211; Height</li>
<li><span class="target" id="cutils.gaussian1d.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian1d.params.a">¶</a> &#8211; Amplitude</li>
<li><span class="target" id="cutils.gaussian1d.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian1d.params.dx">¶</a> &#8211; Position of the center</li>
<li><span class="target" id="cutils.gaussian1d.params.w"></span><strong>w</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian1d.params.w">¶</a> &#8211; FWHM, <span class="math">\(\text{FWHM} = \text{Width} \times 2 \sqrt{2 \ln 2}\)</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.sinc1d">
<code class="descclassname">cutils.</code><code class="descname">sinc1d</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double fwhm</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.sinc1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1D sinc given a set of parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.sinc1d.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.sinc1d.params.x">¶</a> &#8211; 1D array of float64 giving the positions where the
sinc is evaluated</li>
<li><span class="target" id="cutils.sinc1d.params.h"></span><strong>h</strong><a class="paramlink headerlink reference internal" href="#cutils.sinc1d.params.h">¶</a> &#8211; Height</li>
<li><span class="target" id="cutils.sinc1d.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#cutils.sinc1d.params.a">¶</a> &#8211; Amplitude</li>
<li><span class="target" id="cutils.sinc1d.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.sinc1d.params.dx">¶</a> &#8211; Position of the center</li>
<li><span class="target" id="cutils.sinc1d.params.w"></span><strong>w</strong><a class="paramlink headerlink reference internal" href="#cutils.sinc1d.params.w">¶</a> &#8211; FWHM, <span class="math">\(\text{FWHM} = \text{Width} \times 2 \sqrt{2 \ln 2}\)</span></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.sincgauss1d">
<code class="descclassname">cutils.</code><code class="descname">sincgauss1d</code><span class="sig-paren">(</span><em>ndarray x</em>, <em>double h</em>, <em>double a</em>, <em>double dx</em>, <em>double fwhm</em>, <em>double sigma</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.sincgauss1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 1D sinc convoluted with a gaussian of parameter sigma.</p>
<p>If sigma == 0 returns a pure sinc.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.sincgauss1d.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.sincgauss1d.params.x">¶</a> &#8211; 1D array of float64 giving the positions where the
sinc is evaluated</li>
<li><span class="target" id="cutils.sincgauss1d.params.h"></span><strong>h</strong><a class="paramlink headerlink reference internal" href="#cutils.sincgauss1d.params.h">¶</a> &#8211; Height</li>
<li><span class="target" id="cutils.sincgauss1d.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#cutils.sincgauss1d.params.a">¶</a> &#8211; Amplitude</li>
<li><span class="target" id="cutils.sincgauss1d.params.dx"></span><strong>dx</strong><a class="paramlink headerlink reference internal" href="#cutils.sincgauss1d.params.dx">¶</a> &#8211; Position of the center</li>
<li><span class="target" id="cutils.sincgauss1d.params.w"></span><strong>w</strong><a class="paramlink headerlink reference internal" href="#cutils.sincgauss1d.params.w">¶</a> &#8211; FWHM, <span class="math">\(\text{FWHM} = \text{Width} \times 2 \sqrt{2 \ln 2}\)</span></li>
<li><span class="target" id="cutils.sincgauss1d.params.sigma"></span><strong>sigma</strong><a class="paramlink headerlink reference internal" href="#cutils.sincgauss1d.params.sigma">¶</a> &#8211; Sigma of the gaussian.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.interf_mean_energy">
<code class="descclassname">cutils.</code><code class="descname">interf_mean_energy</code><span class="sig-paren">(</span><em>ndarray interf</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.interf_mean_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean energy of an interferogram by step.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.interf_mean_energy.params.interf"></span><strong>interf</strong><a class="paramlink headerlink reference internal" href="#cutils.interf_mean_energy.params.interf">¶</a> &#8211; an interferogram</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The mean of the interferogram is substracted to
compute only the modulation energy. This is the modulation
energy which must be conserved in the resulting spectrum. Note
that the interferogram transformation function (see
<code class="xref py py-meth docutils literal"><span class="pre">utils.transform_interferogram()</span></code>) remove the mean of the
interferogram before computing its FFT.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">NaNs are counted as zeros.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="cutils.spectrum_mean_energy">
<code class="descclassname">cutils.</code><code class="descname">spectrum_mean_energy</code><span class="sig-paren">(</span><em>ndarray spectrum</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.spectrum_mean_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the mean energy of a spectrum by channel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.spectrum_mean_energy.params.spectrum"></span><strong>spectrum</strong><a class="paramlink headerlink reference internal" href="#cutils.spectrum_mean_energy.params.spectrum">¶</a> &#8211; a 1D spectrum</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">NaNs are counted as zeros.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="cutils.fft_filter">
<code class="descclassname">cutils.</code><code class="descname">fft_filter</code><span class="sig-paren">(</span><em>ndarray a</em>, <em>double cutoff</em>, <em>double width</em>, <em>bool lowpass</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.fft_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple lowpass or highpass FFT filter (high pass or low pass)</p>
<p>Filter shape is a gaussian.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.fft_filter.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#cutils.fft_filter.params.a">¶</a> &#8211; a 1D float64 vector</li>
<li><span class="target" id="cutils.fft_filter.params.cutoff_coeff"></span><strong>cutoff_coeff</strong><a class="paramlink headerlink reference internal" href="#cutils.fft_filter.params.cutoff_coeff">¶</a> &#8211; Coefficient defining the position of the cutoff
frequency (Cutoff frequency = cutoff_coeff * vector length)</li>
<li><span class="target" id="cutils.fft_filter.params.width_coeff"></span><strong>width_coeff</strong><a class="paramlink headerlink reference internal" href="#cutils.fft_filter.params.width_coeff">¶</a> &#8211; Coefficient defining the width of
the smoothed part of the filter (width = width_coeff * vector
length)</li>
<li><span class="target" id="cutils.fft_filter.params.lowpass"></span><strong>lowpass</strong><a class="paramlink headerlink reference internal" href="#cutils.fft_filter.params.lowpass">¶</a> &#8211; If True filter will be &#8216;low_pass&#8217; and &#8216;high_pass&#8217;
if False.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.low_pass_image_filter">
<code class="descclassname">cutils.</code><code class="descname">low_pass_image_filter</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>int deg</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.low_pass_image_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Low pass image filter by convolution with a gaussian kernel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.low_pass_image_filter.params.im"></span><strong>im</strong><a class="paramlink headerlink reference internal" href="#cutils.low_pass_image_filter.params.im">¶</a> &#8211; Image to filter</li>
<li><span class="target" id="cutils.low_pass_image_filter.params.deg"></span><strong>deg</strong><a class="paramlink headerlink reference internal" href="#cutils.low_pass_image_filter.params.deg">¶</a> &#8211; Kernel degree</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.fast_gaussian_kernel">
<code class="descclassname">cutils.</code><code class="descname">fast_gaussian_kernel</code><span class="sig-paren">(</span><em>int deg</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.fast_gaussian_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a fast gaussian kernel.</p>
<p>The value of each pixel is just the value of the gaussian at the
center of the pixel.</p>
<p>The degree gives the size of the kernel&#8217;s side : size = 2 * deg + 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.fast_gaussian_kernel.params.deg"></span><strong>deg</strong><a class="paramlink headerlink reference internal" href="#cutils.fast_gaussian_kernel.params.deg">¶</a> &#8211; The degree of the kernel. Must be an integer &gt;= 0.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.gaussian_kernel">
<code class="descclassname">cutils.</code><code class="descname">gaussian_kernel</code><span class="sig-paren">(</span><em>double deg</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.gaussian_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a gaussian kernel.</p>
<p>The value of each pixel is the integral of the gaussian over the
whole pixel because the shape of the gaussian is not linear at
all. The estimation is done by subdividing each pixel in 9
sub-pixels.</p>
<p>The degree gives the size of the kernel&#8217;s side : size = 2 * deg + 1</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.gaussian_kernel.params.deg"></span><strong>deg</strong><a class="paramlink headerlink reference internal" href="#cutils.gaussian_kernel.params.deg">¶</a> &#8211; The degree of the kernel. Must be an integer &gt;= 0.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.get_box_coords">
<code class="descclassname">cutils.</code><code class="descname">get_box_coords</code><span class="sig-paren">(</span><em>int ix</em>, <em>int iy</em>, <em>int box_size</em>, <em>int x_lim_min</em>, <em>int x_lim_max</em>, <em>int y_lim_min</em>, <em>int y_lim_max</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.get_box_coords" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the coordinates of a box given the center of the box,
its size and the limits of the range along x and y axes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="cutils.get_box_coords.params.ix"></span><strong>ix</strong><a class="paramlink headerlink reference internal" href="#cutils.get_box_coords.params.ix">¶</a> &#8211; center of the box along x axis</li>
<li><span class="target" id="cutils.get_box_coords.params.iy"></span><strong>iy</strong><a class="paramlink headerlink reference internal" href="#cutils.get_box_coords.params.iy">¶</a> &#8211; center of the box along y axis</li>
<li><span class="target" id="cutils.get_box_coords.params.box_size"></span><strong>box_size</strong><a class="paramlink headerlink reference internal" href="#cutils.get_box_coords.params.box_size">¶</a> &#8211; Size of the box. The final size of the box will
generally be the same if box_size is odd. Note that the final
size of the box cannot be guaranteed.</li>
<li><span class="target" id="cutils.get_box_coords.params.x_lim_min"></span><strong>x_lim_min</strong><a class="paramlink headerlink reference internal" href="#cutils.get_box_coords.params.x_lim_min">¶</a> &#8211; Minimum limit of the range along x.</li>
<li><span class="target" id="cutils.get_box_coords.params.x_lim_max"></span><strong>x_lim_max</strong><a class="paramlink headerlink reference internal" href="#cutils.get_box_coords.params.x_lim_max">¶</a> &#8211; Maximum limit of the range along x.</li>
<li><span class="target" id="cutils.get_box_coords.params.y_lim_min"></span><strong>y_lim_min</strong><a class="paramlink headerlink reference internal" href="#cutils.get_box_coords.params.y_lim_min">¶</a> &#8211; Minimum limit of the range along y.</li>
<li><span class="target" id="cutils.get_box_coords.params.y_lim_max"></span><strong>y_lim_max</strong><a class="paramlink headerlink reference internal" href="#cutils.get_box_coords.params.y_lim_max">¶</a> &#8211; Maximum limit of the range along y.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">x_min, x_max, y_min, y_max</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.point_inside_polygon">
<code class="descclassname">cutils.</code><code class="descname">point_inside_polygon</code><span class="sig-paren">(</span><em>double x</em>, <em>double y</em>, <em>list poly</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.point_inside_polygon" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine if a point is inside a given polygon or not
Polygon is a list of (x,y) pairs.</p>
<p>This function has been taken from
<a class="reference external" href="http://www.ariel.com.au/a/python-point-int-poly.html">http://www.ariel.com.au/a/python-point-int-poly.html</a> and cythonized.</p>
</dd></dl>

<dl class="function">
<dt id="cutils.multi_fit_stars">
<code class="descclassname">cutils.</code><code class="descname">multi_fit_stars</code><span class="sig-paren">(</span><em>ndarray frame</em>, <em>ndarray pos</em>, <em>int box_size</em>, <em>double height_guess=np.nan</em>, <em>double fwhm_guess=np.nan</em>, <em>bool cov_height=False</em>, <em>bool cov_pos=True</em>, <em>bool cov_fwhm=True</em>, <em>bool fix_height=False</em>, <em>bool fix_pos=False</em>, <em>bool fix_fwhm=False</em>, <em>double fit_tol=0.001</em>, <em>double ron=np.nan</em>, <em>double dcl=np.nan</em>, <em>bool enable_zoom=False</em>, <em>bool enable_rotation=False</em>, <em>bool estimate_local_noise=True</em>, <em>double saturation=0</em>, <em>sip=None</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.multi_fit_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit multiple stars at the same time.</p>
<p>Useful if the relative positions of the stars are well known. In
this case the pattern of position can be shifted, zoomed and
rotated in order to be adjusted to the stars in the frame.</p>
<p>Other covarying parameters can be the height and the FWHM.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.multi_fit_stars.params.frame"></span><strong>frame</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.frame">¶</a> &#8211; Frame</li>
<li><span class="target" id="cutils.multi_fit_stars.params.pos"></span><strong>pos</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.pos">¶</a> &#8211; array of stars positions of shape [[x1, y1], [x2, y2] ...]</li>
<li><span class="target" id="cutils.multi_fit_stars.params.box_size"></span><strong>box_size</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.box_size">¶</a> &#8211; Size of the box around a single star</li>
<li><span class="target" id="cutils.multi_fit_stars.params.height_guess"></span><strong>height_guess</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.height_guess">¶</a> &#8211; (Optional) Initial guess on the height
parameter (default NaN).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.fwhm_guess"></span><strong>fwhm_guess</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.fwhm_guess">¶</a> &#8211; (Optional) Initial guess on the FWHM parameter
(default NaN).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.cov_height"></span><strong>cov_height</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.cov_height">¶</a> &#8211; (Optional) If True, height is considered to be
the same for all the stars. It is then a covarying parameter
(default False).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.cov_pos"></span><strong>cov_pos</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.cov_pos">¶</a> &#8211; (Optional) If True, shift along x and y is
considered as the same for all the stars. dx and dy are thus 2
covarying parameters (default True).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.cov_fwhm"></span><strong>cov_fwhm</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.cov_fwhm">¶</a> &#8211; (Optional) If True, FWHM is considered to be the
same for all the stars. It is then a covarying parameter
(default True).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.fix_height"></span><strong>fix_height</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.fix_height">¶</a> &#8211; (Optional) If True, height is fixed to its
guess (default False).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.fix_pos"></span><strong>fix_pos</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.fix_pos">¶</a> &#8211; (Optional) If True, x and y are fixed to the position
guess given by pos (default False).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.fix_fwhm"></span><strong>fix_fwhm</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.fix_fwhm">¶</a> &#8211; (Optional) If True, FWHM is fixed to its guess
(default False).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.fit_tol"></span><strong>fit_tol</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.fit_tol">¶</a> &#8211; (Optional) Tolerance on the fit (default 1e-3).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.ron"></span><strong>ron</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.ron">¶</a> &#8211; (Optional) Readout noise. If given and if
estimate_local_noise is set to False the readout noise is fixed
to the given value. If not given the ron is guessed from the
background around the stars (default NaN).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.dcl"></span><strong>dcl</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.dcl">¶</a> &#8211; (Optional) Dark current level. If given and if
estimate_local_noise is set to False the dark current level is
fixed to the given value. If not given the dark current level is
fixed to 0. (default NaN)</li>
<li><span class="target" id="cutils.multi_fit_stars.params.enable_zoom"></span><strong>enable_zoom</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.enable_zoom">¶</a> &#8211; (Optional) If True the position pattern can be
zoomed (default False).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.enable_rotation"></span><strong>enable_rotation</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.enable_rotation">¶</a> &#8211; (Optional) If True the position pattern
can be rotated (default False).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.estimate_local_noise"></span><strong>estimate_local_noise</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.estimate_local_noise">¶</a> &#8211; (Optional) If True, the level of
noise is computed from the background pixels around the
stars. ron and dcl parameters are thus not used (default True).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.saturation"></span><strong>saturation</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.saturation">¶</a> &#8211; (Optional) If not 0, all pixels above the
saturation level are removed from the fit (default 0).</li>
<li><span class="target" id="cutils.multi_fit_stars.params.sip"></span><strong>sip</strong><a class="paramlink headerlink reference internal" href="#cutils.multi_fit_stars.params.sip">¶</a> &#8211; (Optional) A pywcs.WCS instance containing SIP
distorsion correction (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.part_value">
<code class="descclassname">cutils.</code><code class="descname">part_value</code><span class="sig-paren">(</span><em>ndarray distrib</em>, <em>double coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.part_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the value lying between two parts of a partition</p>
<p>The partition process is nan robusts. It is made over a
distribution cleaned from nans.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.part_value.params.distrib"></span><strong>distrib</strong><a class="paramlink headerlink reference internal" href="#cutils.part_value.params.distrib">¶</a> &#8211; A 1D array of floats.</li>
<li><span class="target" id="cutils.part_value.params.coeff"></span><strong>coeff</strong><a class="paramlink headerlink reference internal" href="#cutils.part_value.params.coeff">¶</a> &#8211; Partition coefficient (must be &gt;= 0. and &lt;= 1.). If
0 return the min of the distribution and if 1 return the max.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.indft">
<code class="descclassname">cutils.</code><code class="descname">indft</code><span class="sig-paren">(</span><em>ndarray a</em>, <em>ndarray x</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.indft" title="Permalink to this definition">¶</a></dt>
<dd><p>Inverse Non-uniform Discret Fourier Transform.</p>
<p>Compute the irregularly sampled interferogram from a regularly
sampled spectrum.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.indft.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#cutils.indft.params.a">¶</a> &#8211; regularly sampled spectrum.</li>
<li><span class="target" id="cutils.indft.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#cutils.indft.params.x">¶</a> &#8211; positions of the interferogram samples. If x =
range(size(a)), this function is equivalent to an idft or a
ifft. Note that the ifft is of course much faster to
compute. This vector may have any length.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.map_me">
<code class="descclassname">cutils.</code><code class="descname">map_me</code><span class="sig-paren">(</span><em>ndarray frame</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.map_me" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a map of the modulation efficiency from a laser frame.</p>
<p>The more fringes the best are the results.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="cutils.map_me.params.frame"></span><strong>frame</strong><a class="paramlink headerlink reference internal" href="#cutils.map_me.params.frame">¶</a> &#8211; laser frame.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.nanbin_image">
<code class="descclassname">cutils.</code><code class="descname">nanbin_image</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>int binning</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.nanbin_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Mean image binning robust to NaNs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.nanbin_image.params.im"></span><strong>im</strong><a class="paramlink headerlink reference internal" href="#cutils.nanbin_image.params.im">¶</a> &#8211; Image to bin</li>
<li><span class="target" id="cutils.nanbin_image.params.binning"></span><strong>binning</strong><a class="paramlink headerlink reference internal" href="#cutils.nanbin_image.params.binning">¶</a> &#8211; Binning factor (must be an integer)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.unbin_image">
<code class="descclassname">cutils.</code><code class="descname">unbin_image</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>int nx</em>, <em>int ny</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.unbin_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Unbin a binned image (restore the image binned with the
function <code class="xref py py-func docutils literal"><span class="pre">nanbin_image()</span></code>).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.unbin_image.params.im"></span><strong>im</strong><a class="paramlink headerlink reference internal" href="#cutils.unbin_image.params.im">¶</a> &#8211; Image to unbin.</li>
<li><span class="target" id="cutils.unbin_image.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#cutils.unbin_image.params.nx">¶</a> &#8211; X dimension of the unbinned image.</li>
<li><span class="target" id="cutils.unbin_image.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#cutils.unbin_image.params.ny">¶</a> &#8211; Y dimension of the unbinned image.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.im2rgba">
<code class="descclassname">cutils.</code><code class="descname">im2rgba</code><span class="sig-paren">(</span><em>ndarray im</em>, <em>mpl_colorbar</em>, <em>double vmin</em>, <em>double vmax</em>, <em>int xmin</em>, <em>int xmax</em>, <em>int ymin</em>, <em>int ymax</em>, <em>ndarray computed_pixels</em>, <em>last_arr8</em>, <em>int res=1000</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.im2rgba" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute RGBA from image given a matplotlib colorbar instance.</p>
<p>This is a function used by <code class="xref py py-class docutils literal"><span class="pre">orb.visual.ImageCanvas</span></code>. It
is not a generalist function. It has been written to accelerate
matplotlib function colorbar.to_rgba().</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.im2rgba.params.im"></span><strong>im</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.im">¶</a> &#8211; Image</li>
<li><span class="target" id="cutils.im2rgba.params.mpl_colorbar"></span><strong>mpl_colorbar</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.mpl_colorbar">¶</a> &#8211; A matplotlib colorbar instance</li>
<li><span class="target" id="cutils.im2rgba.params.vmin"></span><strong>vmin</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.vmin">¶</a> &#8211; min value of the colorbar</li>
<li><span class="target" id="cutils.im2rgba.params.vmax"></span><strong>vmax</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.vmax">¶</a> &#8211; max value of the colorbar</li>
<li><span class="target" id="cutils.im2rgba.params.xmin"></span><strong>xmin</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.xmin">¶</a> &#8211; min x index of the region to compute</li>
<li><span class="target" id="cutils.im2rgba.params.xmax"></span><strong>xmax</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.xmax">¶</a> &#8211; max x index of the region to compute</li>
<li><span class="target" id="cutils.im2rgba.params.ymin"></span><strong>ymin</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.ymin">¶</a> &#8211; min y index of the region to compute</li>
<li><span class="target" id="cutils.im2rgba.params.ymax"></span><strong>ymax</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.ymax">¶</a> &#8211; max y index of the region to compute</li>
<li><span class="target" id="cutils.im2rgba.params.computed_pixels"></span><strong>computed_pixels</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.computed_pixels">¶</a> &#8211; Array giving the already computed pixels</li>
<li><span class="target" id="cutils.im2rgba.params.last_arr8"></span><strong>last_arr8</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.last_arr8">¶</a> &#8211; If not None, last computed array.</li>
<li><span class="target" id="cutils.im2rgba.params.res"></span><strong>res</strong><a class="paramlink headerlink reference internal" href="#cutils.im2rgba.params.res">¶</a> &#8211; (Optional) Lookup table resolution (default 1000)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.detect_cosmic_rays">
<code class="descclassname">cutils.</code><code class="descname">detect_cosmic_rays</code><span class="sig-paren">(</span><em>ndarray frame</em>, <em>crs_list</em>, <em>int box_size</em>, <em>double detect_coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.detect_cosmic_rays" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if a given pixel is a cosmic ray (classic detection).</p>
<p>classic detection: pixel value is checked against standard
deviation of values in a box around the pixel.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.detect_cosmic_rays.params.frame"></span><strong>frame</strong><a class="paramlink headerlink reference internal" href="#cutils.detect_cosmic_rays.params.frame">¶</a> &#8211; Frame to check</li>
<li><span class="target" id="cutils.detect_cosmic_rays.params.crs_list"></span><strong>crs_list</strong><a class="paramlink headerlink reference internal" href="#cutils.detect_cosmic_rays.params.crs_list">¶</a> &#8211; List of pixels to check</li>
<li><span class="target" id="cutils.detect_cosmic_rays.params.box_size"></span><strong>box_size</strong><a class="paramlink headerlink reference internal" href="#cutils.detect_cosmic_rays.params.box_size">¶</a> &#8211; Size of the box in pixels</li>
<li><span class="target" id="cutils.detect_cosmic_rays.params.detect_coeff"></span><strong>detect_coeff</strong><a class="paramlink headerlink reference internal" href="#cutils.detect_cosmic_rays.params.detect_coeff">¶</a> &#8211; Coefficient of detection (number of sigmas
threshold)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.check_cosmic_rays_neighbourhood">
<code class="descclassname">cutils.</code><code class="descname">check_cosmic_rays_neighbourhood</code><span class="sig-paren">(</span><em>ndarray frame</em>, <em>ndarray cr_map</em>, <em>int box_size</em>, <em>double detect_coeff</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.check_cosmic_rays_neighbourhood" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the neighbourhood around detected cosmic rays in a frame.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.check_cosmic_rays_neighbourhood.params.frame"></span><strong>frame</strong><a class="paramlink headerlink reference internal" href="#cutils.check_cosmic_rays_neighbourhood.params.frame">¶</a> &#8211; Frame to check</li>
<li><span class="target" id="cutils.check_cosmic_rays_neighbourhood.params.cr_map"></span><strong>cr_map</strong><a class="paramlink headerlink reference internal" href="#cutils.check_cosmic_rays_neighbourhood.params.cr_map">¶</a> &#8211; Map of the cosimic-rays positions (boolean map, 1
is a cosmic ray)</li>
<li><span class="target" id="cutils.check_cosmic_rays_neighbourhood.params.box_size"></span><strong>box_size</strong><a class="paramlink headerlink reference internal" href="#cutils.check_cosmic_rays_neighbourhood.params.box_size">¶</a> &#8211; Size of the box checked around each cr.</li>
<li><span class="target" id="cutils.check_cosmic_rays_neighbourhood.params.detect_coeff"></span><strong>detect_coeff</strong><a class="paramlink headerlink reference internal" href="#cutils.check_cosmic_rays_neighbourhood.params.detect_coeff">¶</a> &#8211; Coefficient of detection (number of sigmas
threshold)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.fast_w2pix">
<code class="descclassname">cutils.</code><code class="descname">fast_w2pix</code><span class="sig-paren">(</span><em>ndarray w</em>, <em>double axis_min</em>, <em>double axis_step</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.fast_w2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast conversion of wavelength/wavenumber to pixel</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.fast_w2pix.params.w"></span><strong>w</strong><a class="paramlink headerlink reference internal" href="#cutils.fast_w2pix.params.w">¶</a> &#8211; wavelength/wavenumber</li>
<li><span class="target" id="cutils.fast_w2pix.params.axis_min"></span><strong>axis_min</strong><a class="paramlink headerlink reference internal" href="#cutils.fast_w2pix.params.axis_min">¶</a> &#8211; min axis wavelength/wavenumber</li>
<li><span class="target" id="cutils.fast_w2pix.params.axis_step"></span><strong>axis_step</strong><a class="paramlink headerlink reference internal" href="#cutils.fast_w2pix.params.axis_step">¶</a> &#8211; axis step size in wavelength/wavenumber</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.fast_pix2w">
<code class="descclassname">cutils.</code><code class="descname">fast_pix2w</code><span class="sig-paren">(</span><em>ndarray pix</em>, <em>double axis_min</em>, <em>double axis_step</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.fast_pix2w" title="Permalink to this definition">¶</a></dt>
<dd><p>Fast conversion of pixel to wavelength/wavenumber</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.fast_pix2w.params.pix"></span><strong>pix</strong><a class="paramlink headerlink reference internal" href="#cutils.fast_pix2w.params.pix">¶</a> &#8211; position along axis in pixels</li>
<li><span class="target" id="cutils.fast_pix2w.params.axis_min"></span><strong>axis_min</strong><a class="paramlink headerlink reference internal" href="#cutils.fast_pix2w.params.axis_min">¶</a> &#8211; min axis wavelength/wavenumber</li>
<li><span class="target" id="cutils.fast_pix2w.params.axis_step"></span><strong>axis_step</strong><a class="paramlink headerlink reference internal" href="#cutils.fast_pix2w.params.axis_step">¶</a> &#8211; axis step size in wavelength/wavenumber</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.get_cm1_axis_min">
<code class="descclassname">cutils.</code><code class="descname">get_cm1_axis_min</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.get_cm1_axis_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return min wavenumber of a regular wavenumber axis in cm-1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.get_cm1_axis_min.params.n"></span><strong>n</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_min.params.n">¶</a> &#8211; Number of steps on the axis</li>
<li><span class="target" id="cutils.get_cm1_axis_min.params.step"></span><strong>step</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_min.params.step">¶</a> &#8211; Step size in nm</li>
<li><span class="target" id="cutils.get_cm1_axis_min.params.order"></span><strong>order</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_min.params.order">¶</a> &#8211; Folding order</li>
<li><span class="target" id="cutils.get_cm1_axis_min.params.corr"></span><strong>corr</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_min.params.corr">¶</a> &#8211; (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.get_cm1_axis_max">
<code class="descclassname">cutils.</code><code class="descname">get_cm1_axis_max</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.get_cm1_axis_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return max wavenumber of a regular wavenumber axis in cm-1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.get_cm1_axis_max.params.n"></span><strong>n</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_max.params.n">¶</a> &#8211; Number of steps on the axis</li>
<li><span class="target" id="cutils.get_cm1_axis_max.params.step"></span><strong>step</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_max.params.step">¶</a> &#8211; Step size in nm</li>
<li><span class="target" id="cutils.get_cm1_axis_max.params.order"></span><strong>order</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_max.params.order">¶</a> &#8211; Folding order</li>
<li><span class="target" id="cutils.get_cm1_axis_max.params.corr"></span><strong>corr</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_max.params.corr">¶</a> &#8211; (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.get_cm1_axis_step">
<code class="descclassname">cutils.</code><code class="descname">get_cm1_axis_step</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.get_cm1_axis_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Return step size of a regular wavenumber axis in cm-1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.get_cm1_axis_step.params.n"></span><strong>n</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_step.params.n">¶</a> &#8211; Number of steps on the axis</li>
<li><span class="target" id="cutils.get_cm1_axis_step.params.step"></span><strong>step</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_step.params.step">¶</a> &#8211; Step size in nm</li>
<li><span class="target" id="cutils.get_cm1_axis_step.params.corr"></span><strong>corr</strong><a class="paramlink headerlink reference internal" href="#cutils.get_cm1_axis_step.params.corr">¶</a> &#8211; (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.get_nm_axis_min">
<code class="descclassname">cutils.</code><code class="descname">get_nm_axis_min</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.get_nm_axis_min" title="Permalink to this definition">¶</a></dt>
<dd><p>Return min wavelength of regular wavelength axis in nm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.get_nm_axis_min.params.n"></span><strong>n</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_min.params.n">¶</a> &#8211; Number of steps on the axis</li>
<li><span class="target" id="cutils.get_nm_axis_min.params.step"></span><strong>step</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_min.params.step">¶</a> &#8211; Step size in nm</li>
<li><span class="target" id="cutils.get_nm_axis_min.params.order"></span><strong>order</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_min.params.order">¶</a> &#8211; Folding order (cannot be 0)</li>
<li><span class="target" id="cutils.get_nm_axis_min.params.corr"></span><strong>corr</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_min.params.corr">¶</a> &#8211; (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.get_nm_axis_max">
<code class="descclassname">cutils.</code><code class="descname">get_nm_axis_max</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.get_nm_axis_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Return max wavelength of regular wavelength axis in nm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.get_nm_axis_max.params.n"></span><strong>n</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_max.params.n">¶</a> &#8211; Number of steps on the axis</li>
<li><span class="target" id="cutils.get_nm_axis_max.params.step"></span><strong>step</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_max.params.step">¶</a> &#8211; Step size in nm</li>
<li><span class="target" id="cutils.get_nm_axis_max.params.order"></span><strong>order</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_max.params.order">¶</a> &#8211; Folding order (cannot be 0)</li>
<li><span class="target" id="cutils.get_nm_axis_max.params.corr"></span><strong>corr</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_max.params.corr">¶</a> &#8211; (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.get_nm_axis_step">
<code class="descclassname">cutils.</code><code class="descname">get_nm_axis_step</code><span class="sig-paren">(</span><em>int n</em>, <em>double step</em>, <em>int order</em>, <em>double corr=1.0</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.get_nm_axis_step" title="Permalink to this definition">¶</a></dt>
<dd><p>Return step size of a regular wavelength axis in nm.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.get_nm_axis_step.params.n"></span><strong>n</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_step.params.n">¶</a> &#8211; Number of steps on the axis</li>
<li><span class="target" id="cutils.get_nm_axis_step.params.step"></span><strong>step</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_step.params.step">¶</a> &#8211; Step size in nm</li>
<li><span class="target" id="cutils.get_nm_axis_step.params.order"></span><strong>order</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_step.params.order">¶</a> &#8211; Folding order (cannot be 0)</li>
<li><span class="target" id="cutils.get_nm_axis_step.params.corr"></span><strong>corr</strong><a class="paramlink headerlink reference internal" href="#cutils.get_nm_axis_step.params.corr">¶</a> &#8211; (Optional) Coefficient of correction (default 1.)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="cutils.compute_radial_velocity">
<code class="descclassname">cutils.</code><code class="descname">compute_radial_velocity</code><span class="sig-paren">(</span><em>ndarray line</em>, <em>ndarray rest_line</em>, <em>bool wavenumber=False</em><span class="sig-paren">)</span><a class="headerlink" href="#cutils.compute_radial_velocity" title="Permalink to this definition">¶</a></dt>
<dd><p>Return radial velocity in km.s-1</p>
<p>V [km.s-1] = c [km.s-1]* (Lambda - Lambda_0) / Lambda_0</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="cutils.compute_radial_velocity.params.line"></span><strong>line</strong><a class="paramlink headerlink reference internal" href="#cutils.compute_radial_velocity.params.line">¶</a> &#8211; Emission line wavelength/wavenumber (can be a numpy
array)</li>
<li><span class="target" id="cutils.compute_radial_velocity.params.rest_line"></span><strong>rest_line</strong><a class="paramlink headerlink reference internal" href="#cutils.compute_radial_velocity.params.rest_line">¶</a> &#8211; Rest-frame wavelength/wavenumber (can be a numpy
array but must have the same size as line)</li>
<li><span class="target" id="cutils.compute_radial_velocity.params.wavenumber"></span><strong>wavenumber</strong><a class="paramlink headerlink reference internal" href="#cutils.compute_radial_velocity.params.wavenumber">¶</a> &#8211; (Optional) If True the result is returned in cm-1,
else it is returned in nm.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="astrometry_module.html" class="btn btn-neutral float-right" title="Astrometry module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="utils_module.html" class="btn btn-neutral" title="Utils module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Thomas Martin (thomas.martin.1@ulaval.ca).

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.6.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>