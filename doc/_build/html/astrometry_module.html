

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Astrometry module &mdash; Orb 1.4.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/logo.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/sphinx_paramlinks.css" type="text/css" />
  

  
    <link rel="top" title="Orb 1.4.0 documentation" href="index.html"/>
        <link rel="next" title="Visual module" href="visual_module.html"/>
        <link rel="prev" title="CUtils module" href="cutils_module.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        

        
          <a href="index.html" class="icon icon-home"> Orb
        

        
          
          <img src="_static/logo.png" class="logo" />
        
        </a>

        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

        
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="installing_orb.html">Installing Orb</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installing_orb.html#unpacking">Unpacking</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installing_orb.html#make-orb-accessible-to-all-users">Make ORB accessible to all users</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_orb.html#make-orb-accessible-to-you-alone">Make ORB accessible to you alone</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installing_python.html">Installing Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installing_python.html#python">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="installing_python.html#modules">Modules</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#to-use-the-viewer-orb-viewer">To use the Viewer (orb-viewer)</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#scipy-and-numpy">Scipy and Numpy</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#pyfits">PyFITS</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#parallel-python">Parallel Python</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#pywcs">PyWCS</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#bottleneck">Bottleneck</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#h5py">h5py</a><ul>
<li class="toctree-l4"><a class="reference internal" href="installing_python.html#install-szip">Install SZIP</a></li>
<li class="toctree-l4"><a class="reference internal" href="installing_python.html#install-hdf5">Install HDF5</a></li>
<li class="toctree-l4"><a class="reference internal" href="installing_python.html#install-h5py-pip-cannot-be-used-directly">Install H5PY (pip cannot be used directly)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#tkinter">Tkinter</a></li>
<li class="toctree-l3"><a class="reference internal" href="installing_python.html#cython">Cython</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="python_for_orb.html">Python for ORB users</a><ul>
<li class="toctree-l2"><a class="reference internal" href="python_for_orb.html#the-basics">The basics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python_for_orb.html#hello-world">Hello world</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_for_orb.html#handling-arrays">Handling arrays</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_for_orb.html#a-simple-loop">A simple loop</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_for_orb.html#plotting-data">Plotting data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="python_for_orb.html#importing-and-using-orb">Importing and using ORB</a><ul>
<li class="toctree-l3"><a class="reference internal" href="python_for_orb.html#importing-orb">Importing ORB</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_for_orb.html#reading-and-writing-fits">Reading and writing FITS</a></li>
<li class="toctree-l3"><a class="reference internal" href="python_for_orb.html#loading-large-cubes-or-reduction-data">Loading large cubes or reduction data</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_analysis_with_orb.html">Data analysis with ORB</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_analysis_with_orb.html#analyzing-interferometric-data">Analyzing interferometric data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data_analysis_with_orb.html#creating-an-interferometric-cube">Creating an interferometric cube</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="core_module.html">Core module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#tools-class">Tools class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#cube-class">Cube class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#hdfcube-class">HDFCube class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#outhdfcube-class">OutHDFCube class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#textcolor-class">TextColor class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#progressbar-class">ProgressBar class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#memfile-class">MemFile class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#indexer-class">Indexer class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#lines-class">Lines class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#optionfile-class">OptionFile class</a></li>
<li class="toctree-l2"><a class="reference internal" href="core_module.html#paramsfile-class">ParamsFile class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="utils_module.html">Utils module</a></li>
<li class="toctree-l1"><a class="reference internal" href="cutils_module.html">CUtils module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cutils_module.html#contents">Contents</a></li>
<li class="toctree-l2"><a class="reference internal" href="cutils_module.html#module-cutils">Cutils</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Astrometry module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#astrometry-class">Astrometry class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aligner-class">Aligner class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#starsparams-class">StarsParams class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#psf-class">PSF class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gaussian-class">Gaussian class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#moffat-class">Moffat class</a></li>
<li class="toctree-l2"><a class="reference internal" href="#astrometry-functions">Astrometry functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visual_module.html">Visual module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="visual_module.html#baseviewer-class">BaseViewer class</a></li>
<li class="toctree-l2"><a class="reference internal" href="visual_module.html#popupwindow-class">PopupWindow class</a></li>
<li class="toctree-l2"><a class="reference internal" href="visual_module.html#headerwindow-class">HeaderWindow class</a></li>
<li class="toctree-l2"><a class="reference internal" href="visual_module.html#zplotwindow-class">ZPlotWindow class</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_module.html">Data module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_module.html#data-functions">Data functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_module.html#data1d-class">Data1D class</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_module.html#data2d-class">Data2D class</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="changelog.html">Changelog</a><ul>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v1-0-creation-of-orb">v1.0 Creation of ORB</a></li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v1-1">v1.1</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#multi-fit-of-stars">Multi fit of stars</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#usno-b1-based-star-detection">USNO-B1 based star detection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v1-2">v1.2</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-2-1">v1.2.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-2-2">v1.2.2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#orcs-integration">ORCS integration</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#orb-s-scripts">ORB&#8217;s scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-2-3">v1.2.3</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-2-4">v1.2.4</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#miscellaneous">Miscellaneous</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#sitelle-data">SITELLE data</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-2-4-1">v1.2.4.1</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-2-4-2">v1.2.4.2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#astropy">Astropy</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#better-star-fit">Better Star fit</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#spiomm-bias-overscan-for-camera-2">SpIOMM bias overscan for camera 2</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#id1">Miscellaneous</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v1-3-start-of-cfht-integration">v1.3 Start of CFHT integration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-3-0-orb-viewer">v1.3.0 ORB-Viewer</a></li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-3-1">v1.3.1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#orb-header">orb-header</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#id2">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-3-2">v1.3.2</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#scripts">scripts</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-3-3">v1.3.3</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#alignement">Alignement</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#sip-distorsion">SIP/Distorsion</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#hdf5">HDF5</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-3-4-0">v1.3.4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#binning-detection">Binning detection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-3-4-1">v1.3.4.1</a><ul>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#doc-update">Doc update</a></li>
<li class="toctree-l4"><a class="reference internal" href="changelog.html#id3">Miscellaneous</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="changelog.html#v1-4-the-hdf5-miracle">v1.4 The HDF5 miracle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="changelog.html#v1-4-0">v1.4.0</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Orb</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Astrometry module</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/astrometry_module.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="astrometry-module">
<h1><a class="toc-backref" href="#id1">Astrometry module</a><a class="headerlink" href="#astrometry-module" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#astrometry-module" id="id1">Astrometry module</a><ul>
<li><a class="reference internal" href="#astrometry-class" id="id2">Astrometry class</a></li>
<li><a class="reference internal" href="#aligner-class" id="id3">Aligner class</a></li>
<li><a class="reference internal" href="#starsparams-class" id="id4">StarsParams class</a></li>
<li><a class="reference internal" href="#psf-class" id="id5">PSF class</a></li>
<li><a class="reference internal" href="#gaussian-class" id="id6">Gaussian class</a></li>
<li><a class="reference internal" href="#moffat-class" id="id7">Moffat class</a></li>
<li><a class="reference internal" href="#astrometry-functions" id="id8">Astrometry functions</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="astrometry-class">
<h2><a class="toc-backref" href="#id2">Astrometry class</a><a class="headerlink" href="#astrometry-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="astrometry.Astrometry">
<em class="property">class </em><code class="descclassname">astrometry.</code><code class="descname">Astrometry</code><span class="sig-paren">(</span><em>data</em>, <em>fwhm_arc</em>, <em>fov</em>, <em>profile_name='gaussian'</em>, <em>detect_stack=5</em>, <em>fit_tol=0.01</em>, <em>moffat_beta=2.1</em>, <em>data_prefix=''</em>, <em>star_list_path=None</em>, <em>box_size_coeff=7.0</em>, <em>check_mask=True</em>, <em>reduced_chi_square_limit=1.5</em>, <em>readout_noise=10.0</em>, <em>dark_current_level=0.0</em>, <em>target_radec=None</em>, <em>target_xy=None</em>, <em>wcs_rotation=None</em>, <em>config_file_name='config.orb'</em>, <em>logfile_name=None</em>, <em>tuning_parameters={}</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_module.html#core.Tools" title="core.Tools"><code class="xref py py-class docutils literal"><span class="pre">core.Tools</span></code></a></p>
<p>Manage all astrometrical processes that can be made on a single
frame of a whole cube.</p>
<p>This class can detect stars in the given data and return fit
parameters. Fit parameters are returned as a
<a class="reference internal" href="#astrometry.StarsParams" title="astrometry.StarsParams"><code class="xref py py-class docutils literal"><span class="pre">StarsParams</span></code></a> object used to store and access
fit parameters.</p>
<p>Possible fitting profiles are at least Gaussian and Moffat. Other
profiles can be created by expanding <a class="reference internal" href="#astrometry.PSF" title="astrometry.PSF"><code class="xref py py-class docutils literal"><span class="pre">PSF</span></code></a>
class.</p>
<dl class="attribute">
<dt id="astrometry.Astrometry.BASE_URL">
<code class="descname">BASE_URL</code><em class="property"> = 'http://webviz.u-strasbg.fr/viz-bin/'</em><a class="headerlink" href="#astrometry.Astrometry.BASE_URL" title="Permalink to this definition">¶</a></dt>
<dd><p>Beginning of the URL to the Vizer server by default</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry._get_combined_frame">
<code class="descname">_get_combined_frame</code><span class="sig-paren">(</span><em>use_deep_frame=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry._get_combined_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a combined frame to work on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry._get_combined_frame.params.use_deep_frame"></span><strong>use_deep_frame</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry._get_combined_frame.params.use_deep_frame">¶</a> &#8211; (Optional) If True returned frame is a
deep frame instead of a combination of the first frames only
(default False)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry._get_fit_results_path">
<code class="descname">_get_fit_results_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry._get_fit_results_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the default path to the file containing all fit
results.</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry._get_star_list_path">
<code class="descname">_get_star_list_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry._get_star_list_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the default path to the star list file.</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.arc2pix">
<code class="descname">arc2pix</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.arc2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixels to arcseconds</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.arc2pix.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.arc2pix.params.x">¶</a> &#8211; a value or a vector in pixel</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.base_url">
<code class="descname">base_url</code><em class="property"> = 'http://webviz.u-strasbg.fr/viz-bin/'</em><a class="headerlink" href="#astrometry.Astrometry.base_url" title="Permalink to this definition">¶</a></dt>
<dd><p>Beginning of the URL to the Vizier server</p>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.base_url_ca">
<code class="descname">base_url_ca</code><em class="property"> = 'http://vizier.hia.nrc.ca/viz-bin/'</em><a class="headerlink" href="#astrometry.Astrometry.base_url_ca" title="Permalink to this definition">¶</a></dt>
<dd><p>Beginning of the URL to the Vizier server in Canada</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.brute_force_guess">
<code class="descname">brute_force_guess</code><span class="sig-paren">(</span><em>image</em>, <em>star_list</em>, <em>x_range</em>, <em>y_range</em>, <em>r_range</em>, <em>rc</em>, <em>zoom_factor</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.brute_force_guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Determine a precise alignment guess by brute force.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Astrometry.brute_force_guess.params.star_list"></span><strong>star_list</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.brute_force_guess.params.star_list">¶</a> &#8211; List of stars</li>
<li><span class="target" id="astrometry.Astrometry.brute_force_guess.params.x_range"></span><strong>x_range</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.brute_force_guess.params.x_range">¶</a> &#8211; range of x values to check</li>
<li><span class="target" id="astrometry.Astrometry.brute_force_guess.params.y_range"></span><strong>y_range</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.brute_force_guess.params.y_range">¶</a> &#8211; range of y values to check</li>
<li><span class="target" id="astrometry.Astrometry.brute_force_guess.params.r_range"></span><strong>r_range</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.brute_force_guess.params.r_range">¶</a> &#8211; range of angle values to check</li>
<li><span class="target" id="astrometry.Astrometry.brute_force_guess.params.rc"></span><strong>rc</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.brute_force_guess.params.rc">¶</a> &#8211; rotation center (rc, ry)</li>
<li><span class="target" id="astrometry.Astrometry.brute_force_guess.params.zoom_factor"></span><strong>zoom_factor</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.brute_force_guess.params.zoom_factor">¶</a> &#8211; zoom_factor</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.dark_current_level">
<code class="descname">dark_current_level</code><em class="property"> = None</em><a class="headerlink" href="#astrometry.Astrometry.dark_current_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Dark current level in ADU/pixel (can be computed from dark frames:
median(master_dark_frame))</p>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.detect_stack">
<code class="descname">detect_stack</code><em class="property"> = None</em><a class="headerlink" href="#astrometry.Astrometry.detect_stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of frames stacked together to create one median frame
used for star detection</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.detect_stars">
<code class="descname">detect_stars</code><span class="sig-paren">(</span><em>min_star_number=4</em>, <em>no_save=False</em>, <em>saturation_threshold=35000</em>, <em>try_catalogue=False</em>, <em>use_deep_frame=False</em>, <em>r_max_coeff=0.6</em>, <em>filter_image=True</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.detect_stars" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect star positions in data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.index"></span><strong>index</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.index">¶</a> &#8211; Minimum index of the images used for star detection.</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.min_star_number"></span><strong>min_star_number</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.min_star_number">¶</a> &#8211; Minimum number of stars to
detect. Must be greater or equal to 4 (minimum star number
for any alignment process).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.no_save"></span><strong>no_save</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.no_save">¶</a> &#8211; (Optional) If True do not save the list of
detected stars in a file, only return a list (default
False).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.saturation_threshold"></span><strong>saturation_threshold</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.saturation_threshold">¶</a> &#8211; (Optional) Number of counts above
which the star can be considered as saturated. Very low by
default because at the ZPD the intensity of a star can be
twice the intensity far from it (default 35000).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.try_catalogue"></span><strong>try_catalogue</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.try_catalogue">¶</a> &#8211; (Optional) If True, try to use a star
catalogue (e.g. USNO-B1) to detect stars if target_ra,
target_dec, target_x, target_y and wcs_rotation parameters
have been given (see
<a class="reference internal" href="#astrometry.Astrometry.query_vizier" title="astrometry.Astrometry.query_vizier"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.Astrometry.query_vizier()</span></code></a>, default
False).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.use_deep_frame"></span><strong>use_deep_frame</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.use_deep_frame">¶</a> &#8211; (Optional) If True a deep frame of the
cube is used instead of combinig only the first frames
(default False).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.r_max_coeff"></span><strong>r_max_coeff</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.r_max_coeff">¶</a> &#8211; (Optional) Coefficient that sets the limit
radius of the stars (default 0.6).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars.params.filter_image"></span><strong>filter_image</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars.params.filter_image">¶</a> &#8211; (Optional) If True, image is filtered
before detection to remove nebulosities (default True).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(star_list_path, mean_fwhm_arc) : (a path to a list
of the dected stars, the mean FWHM of the stars in arcsec)</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Star detection walks through 2 steps:</p>
<ol class="last arabic simple">
<li>Preselection of 4 times the minimum number of stars to
detect using a variable threshold with a filter for hot
pixels and stars near the border of the image.</li>
<li>Stars are fitted to test if they are &#8216;real&#8217; stars. The
most luminous stars (that do not saturate) are
eventually taken.</li>
</ol>
</div>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.detect_stars_from_catalogue">
<code class="descname">detect_stars_from_catalogue</code><span class="sig-paren">(</span><em>min_star_number=4</em>, <em>no_save=False</em>, <em>saturation_threshold=35000</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.detect_stars_from_catalogue" title="Permalink to this definition">¶</a></dt>
<dd><p>Detect star positions in data from a catalogue.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="astrometry.Astrometry.detect_stars_from_catalogue.params.index"></span><strong>index</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars_from_catalogue.params.index">¶</a> &#8211; Minimum index of the images used for star detection.</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars_from_catalogue.params.min_star_number"></span><strong>min_star_number</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars_from_catalogue.params.min_star_number">¶</a> &#8211; Minimum number of stars to
detect. Must be greater or equal to 4 (minimum star number
for any alignment process).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars_from_catalogue.params.no_save"></span><strong>no_save</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars_from_catalogue.params.no_save">¶</a> &#8211; if True do not save the list of detected stars
in a file, only return a list (default False).</li>
<li><span class="target" id="astrometry.Astrometry.detect_stars_from_catalogue.params.saturation_threshold"></span><strong>saturation_threshold</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.detect_stars_from_catalogue.params.saturation_threshold">¶</a> &#8211; Number of counts above which the
star can be considered as saturated. Very low by default
because at the ZPD the intensity of a star can be twice the
intensity far from it (default 35000).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(star_list_path, mean_fwhm_arc) : (a path to a list
of the dected stars, the mean FWHM of the stars in arcsec)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.fit_results">
<code class="descname">fit_results</code><em class="property"> = None</em><a class="headerlink" href="#astrometry.Astrometry.fit_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Array containing all the resulting parameters (as dictionaries)
of the fit of each star in each frame</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.fit_sip">
<code class="descname">fit_sip</code><span class="sig-paren">(</span><em>star_list1</em>, <em>star_list2</em>, <em>params=None</em>, <em>init_sip=None</em>, <em>err=None</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.fit_sip" title="Permalink to this definition">¶</a></dt>
<dd><p>FIT the distorsion correction polynomial to match two lists
of stars (the list of stars 2 is distorded to match the list
of stars 1).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Astrometry.fit_sip.params.star_list1"></span><strong>star_list1</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_sip.params.star_list1">¶</a> &#8211; list of stars 1</li>
<li><span class="target" id="astrometry.Astrometry.fit_sip.params.star_list2"></span><strong>star_list2</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_sip.params.star_list2">¶</a> &#8211; list of stars 2</li>
<li><span class="target" id="astrometry.Astrometry.fit_sip.params.params"></span><strong>params</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_sip.params.params">¶</a> &#8211; (Optional) Transformation parameter to go from
the list of stars 1 to the list of stars 2. Must be a tuple
[dx, dy, dr, da, db, rcx, rcy, zoom_factor] (default None).</li>
<li><span class="target" id="astrometry.Astrometry.fit_sip.params.init_sip"></span><strong>init_sip</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_sip.params.init_sip">¶</a> &#8211; (Optional) Initial SIP (an astropy.wcs.WCS object,
default None)</li>
<li><span class="target" id="astrometry.Astrometry.fit_sip.params.err"></span><strong>err</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_sip.params.err">¶</a> &#8211; (Optional) error on the star positions of the star
list 2 (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.fit_stars_in_cube">
<code class="descname">fit_stars_in_cube</code><span class="sig-paren">(</span><em>correct_alignment=False</em>, <em>save=False</em>, <em>add_cube=None</em>, <em>hpfilter=False</em>, <em>fix_height=True</em>, <em>fix_beta=True</em>, <em>fix_fwhm=False</em>, <em>fwhm_min=0.5</em>, <em>local_background=True</em>, <em>no_aperture_photometry=False</em>, <em>fix_aperture_size=False</em>, <em>precise_guess=False</em>, <em>aper_coeff=3.0</em>, <em>blur=False</em>, <em>no_fit=False</em>, <em>estimate_local_noise=True</em>, <em>multi_fit=False</em>, <em>enable_zoom=False</em>, <em>enable_rotation=False</em>, <em>saturation=None</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.fit_stars_in_cube" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit stars in the cube.</p>
<p>Frames must not be too disaligned. Disalignment can be
corrected as the cube is fitted by setting correct_alignment
option to True.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>2 fitting modes are possible:</p>
<div class="highlight-python"><div class="highlight"><pre>* Individual fit mode [multi_fit=False]
* Multi fit mode [multi_fit=True]
</pre></div>
</div>
<p class="last">see <a class="reference internal" href="#astrometry.fit_stars_in_frame" title="astrometry.fit_stars_in_frame"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.fit_stars_in_frame()</span></code></a> for more
information.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.correct_alignment"></span><strong>correct_alignment</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.correct_alignment">¶</a> &#8211; (Optional) If True, the initial star
positions from the star list are corrected by their last
recorded deviation. Useful when the cube is smoothly
disaligned from one frame to the next.</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.save"></span><strong>save</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.save">¶</a> &#8211; (Optional) If True save the fit results in a file
(default True).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.add_cube"></span><strong>add_cube</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.add_cube">¶</a> &#8211; (Optional) A tuple [Cube instance,
coeff]. This cube is added to the data before the fit so
that the fitted data is self.data[] + coeff * Cube[].</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.hpfilter"></span><strong>hpfilter</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.hpfilter">¶</a> &#8211; (Optional) If True, frames are HP filtered
before fitting stars. Useful for alignment purpose if there
are too much nebulosities in the frames. This option must
not be used for photometry (default False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.fix_height"></span><strong>fix_height</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.fix_height">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.fix_height" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.fix_height</span></code></a>
(default True)</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.fix_beta"></span><strong>fix_beta</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.fix_beta">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.fix_beta" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.fix_beta</span></code></a> (default
True).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.fix_fwhm"></span><strong>fix_fwhm</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.fix_fwhm">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.fix_fwhm" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.fix_fwhm</span></code></a>
(default False)</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.fwhm_min"></span><strong>fwhm_min</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.fwhm_min">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.fix_min" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.fix_min</span></code></a> (default
0.5)</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.local_background"></span><strong>local_background</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.local_background">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.local_background" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.local_background</span></code></a>
(default True).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.no_aperture_photometry"></span><strong>no_aperture_photometry</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.no_aperture_photometry">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.no_aperture_photometry" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.no_aperture_photometry</span></code></a>
(default False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.fix_aperture_size"></span><strong>fix_aperture_size</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.fix_aperture_size">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.fix_aperture_size" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.fix_aperture_size</span></code></a>
(default False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.precise_guess"></span><strong>precise_guess</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.precise_guess">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.precise_guess" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.precise_guess</span></code></a>
(default False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.aper_coeff"></span><strong>aper_coeff</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.aper_coeff">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.aper_coeff" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.aper_coeff</span></code></a>
(default 3).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.blur"></span><strong>blur</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.blur">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.blur" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.blur</span></code></a> (default
False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.no_fit"></span><strong>no_fit</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.no_fit">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.no_fit" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.no_fit</span></code></a> (default
False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.estimate_local_noise"></span><strong>estimate_local_noise</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.estimate_local_noise">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.estimate_local_noise" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.estimate_local_noise</span></code></a>
(default True).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.multi_fit"></span><strong>multi_fit</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.multi_fit">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.multi_fit" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.multi_fit</span></code></a> (default
False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.enable_zoom"></span><strong>enable_zoom</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.enable_zoom">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.enable_zoom" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.enable_zoom</span></code></a>
(default False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.enable_rotation"></span><strong>enable_rotation</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.enable_rotation">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.enable_rotation" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.enable_rotation</span></code></a>
(default False).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_cube.params.saturation"></span><strong>saturation</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_cube.params.saturation">¶</a> &#8211; (Optional) see
<a class="reference internal" href="#astrometry.fit_stars_in_frame.params.saturation" title="astrometry.fit_stars_in_frame"><code class="xref py py-paramref docutils literal"><span class="pre">astrometry.fit_stars_in_frame.saturation</span></code></a>
(default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.fit_stars_in_frame">
<code class="descname">fit_stars_in_frame</code><span class="sig-paren">(</span><em>index</em>, <em>save=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.fit_stars_in_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit stars in one frame.</p>
<p>This function is basically a wrapper around
<a class="reference internal" href="#astrometry.fit_stars_in_frame" title="astrometry.fit_stars_in_frame"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.fit_stars_in_frame()</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>2 fitting modes are possible:</p>
<div class="highlight-python"><div class="highlight"><pre>* Individual fit mode [multi_fit=False]
* Multi fit mode [multi_fit=True]
</pre></div>
</div>
<p class="last">see <a class="reference internal" href="#astrometry.fit_stars_in_frame" title="astrometry.fit_stars_in_frame"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.fit_stars_in_frame()</span></code></a> for more
information.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_frame.params.index"></span><strong>index</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_frame.params.index">¶</a> &#8211; Index of the frame to fit. If index is a frame,
this frame is used instead.</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_frame.params.save"></span><strong>save</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_frame.params.save">¶</a> &#8211; (Optional) If True save the fit results in a file
(default True).</li>
<li><span class="target" id="astrometry.Astrometry.fit_stars_in_frame.params.kwargs"></span><strong>kwargs</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.fit_stars_in_frame.params.kwargs">¶</a> &#8211; Same optional arguments as for
<a class="reference internal" href="#astrometry.fit_stars_in_frame" title="astrometry.fit_stars_in_frame"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.fit_stars_in_frame()</span></code></a>.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Some optional arguments are taken directly from the
values computed at the init of the Class. The following
optional arguments thus cannot be passed:</p>
<div class="last highlight-python"><div class="highlight"><pre>* profile_name
* scale
* fwhm_pix
* beta
* fit_tol
* readout_noise
* dark_current_level
</pre></div>
</div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.fit_tol">
<code class="descname">fit_tol</code><em class="property"> = None</em><a class="headerlink" href="#astrometry.Astrometry.fit_tol" title="Permalink to this definition">¶</a></dt>
<dd><p>Tolerance on the fit parameters</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.get_alignment_vectors">
<code class="descname">get_alignment_vectors</code><span class="sig-paren">(</span><em>fit_cube=False</em>, <em>min_coeff=0.2</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.get_alignment_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Return alignement vectors</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Astrometry.get_alignment_vectors.params.fit_cube"></span><strong>fit_cube</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.get_alignment_vectors.params.fit_cube">¶</a> &#8211; (Optional) If True, the cube is fitted before
using the fit results to create the alignement vectors. Else
the vectors are created using the fit results already in
memory (default False).</li>
<li><span class="target" id="astrometry.Astrometry.get_alignment_vectors.params.min_coeff"></span><strong>min_coeff</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.get_alignment_vectors.params.min_coeff">¶</a> &#8211; The minimum proportion of stars correctly
fitted to assume a good enough calculated disalignment
(default 0.2).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.load_fit_results">
<code class="descname">load_fit_results</code><span class="sig-paren">(</span><em>fit_results_path=None</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.load_fit_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a file containing the fit results</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.load_star_list">
<code class="descname">load_star_list</code><span class="sig-paren">(</span><em>star_list_path</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.load_star_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a list of stars coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.load_star_list.params.star_list_path"></span><strong>star_list_path</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.load_star_list.params.star_list_path">¶</a> &#8211; The path to the star list file.</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#astrometry.load_star_list" title="astrometry.load_star_list"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.load_star_list()</span></code></a></p>
</div>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.pix2arc">
<code class="descname">pix2arc</code><span class="sig-paren">(</span><em>x</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.pix2arc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert arcseconds to pixels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.pix2arc.params.x"></span><strong>x</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.pix2arc.params.x">¶</a> &#8211; a value or a vector in arcsec</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.query_vizier">
<code class="descname">query_vizier</code><span class="sig-paren">(</span><em>catalog='USNO-B1.0'</em>, <em>max_stars=100</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.query_vizier" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a list of star coordinates around an object in a
given radius based on a query to VizieR Services
(<a class="reference external" href="http://vizier.u-strasbg.fr/viz-bin/VizieR">http://vizier.u-strasbg.fr/viz-bin/VizieR</a>)</p>
<p>Note that the idea of this method has been picked from an IDL
function: QUERYVIZIER
(<a class="reference external" href="http://idlastro.gsfc.nasa.gov/ftp/pro/sockets/queryvizier.pro">http://idlastro.gsfc.nasa.gov/ftp/pro/sockets/queryvizier.pro</a>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Astrometry.query_vizier.params.radius"></span><strong>radius</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.query_vizier.params.radius">¶</a> &#8211; (Optional) Radius around the target in
arc-minutes (default 7).</li>
<li><span class="target" id="astrometry.Astrometry.query_vizier.params.catalog"></span><strong>catalog</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.query_vizier.params.catalog">¶</a> &#8211; (Optional) Catalog to ask on the VizieR
database (see notes) (default &#8216;USNO-B1&#8217;)</li>
<li><span class="target" id="astrometry.Astrometry.query_vizier.params.max_stars"></span><strong>max_stars</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.query_vizier.params.max_stars">¶</a> &#8211; (Optional) Maximum number of row to retrieve
(default 100)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Some catalogs that can be used::
&#8216;V/139&#8217; - Sloan SDSS photometric catalog Release 9 (2012)
&#8216;2MASS-PSC&#8217; - 2MASS point source catalog (2003)
&#8216;GSC2.3&#8217; - Version 2.3.2 of the HST Guide Star Catalog (2006)
&#8216;USNO-B1&#8217; - Verson B1 of the US Naval Observatory catalog (2003)
&#8216;UCAC4&#8217;  - 4th U.S. Naval Observatory CCD Astrograph Catalog (2012)
&#8216;B/DENIS/DENIS&#8217; - 2nd Deep Near Infrared Survey of southern Sky (2005)
&#8216;I/259/TYC2&#8217; - Tycho-2 main catalog (2000)
&#8216;I/311/HIP2&#8217; - Hipparcos main catalog, new reduction (2007)</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.readout_noise">
<code class="descname">readout_noise</code><em class="property"> = None</em><a class="headerlink" href="#astrometry.Astrometry.readout_noise" title="Permalink to this definition">¶</a></dt>
<dd><p>Readout noise in ADU/pixel (can be computed from bias frames:
std(master_bias_frame))</p>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Astrometry.reduced_chi_square_limit">
<code class="descname">reduced_chi_square_limit</code><em class="property"> = None</em><a class="headerlink" href="#astrometry.Astrometry.reduced_chi_square_limit" title="Permalink to this definition">¶</a></dt>
<dd><p>Coefficient on the reduced chi square for bad quality fits
rejection</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.register">
<code class="descname">register</code><span class="sig-paren">(</span><em>max_stars=100</em>, <em>full_deep_frame=False</em>, <em>return_fit_params=False</em>, <em>rscale_coeff=1.0</em>, <em>compute_precision=True</em>, <em>compute_distorsion=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register data and return a corrected pywcs.WCS object.</p>
<p>Precise RA/DEC positions of the stars in the field are
recorded from a catalog of the VIZIER server.</p>
<p>Using the real position of the same stars in the frame, WCS
transformation parameters are optimized.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Astrometry.register.params.max_stars"></span><strong>max_stars</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.register.params.max_stars">¶</a> &#8211; (Optional) Maximum number of stars used to
fit (default 50)</li>
<li><span class="target" id="astrometry.Astrometry.register.params.full_deep_frame"></span><strong>full_deep_frame</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.register.params.full_deep_frame">¶</a> &#8211; (Optional) If True all the frames of
the cube are used to create a deep frame. Use it only when
the frames in the cube are aligned. In the other case only
the first frames are combined together (default False).</li>
<li><span class="target" id="astrometry.Astrometry.register.params.return_fit_params"></span><strong>return_fit_params</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.register.params.return_fit_params">¶</a> &#8211; (Optional) If True return final fit
parameters instead of wcs (default False).</li>
<li><span class="target" id="astrometry.Astrometry.register.params.rscale_coeff"></span><strong>rscale_coeff</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.register.params.rscale_coeff">¶</a> &#8211; (Optional) Coefficient on the maximum
radius of the fitted stars to compute scale. When rscale_coeff
= 1, rmax is half the longer side of the image (default 1).</li>
<li><span class="target" id="astrometry.Astrometry.register.params.compute_distorsion"></span><strong>compute_distorsion</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.register.params.compute_distorsion">¶</a> &#8211; (Optional) If True, optical
distorsion (SIP) are computed. Note that a frame with a lot
of stars is better for this purpose (default False).</li>
<li><span class="target" id="astrometry.Astrometry.register.params.compute_precision"></span><strong>compute_precision</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.register.params.compute_precision">¶</a> &#8211; (Optional) If True, astrometrical
precision is computed (default True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.reset_box_size">
<code class="descname">reset_box_size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.reset_box_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset box size attribute. Useful if FWHM or scale has been
modified after class init.</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.reset_fwhm_arc">
<code class="descname">reset_fwhm_arc</code><span class="sig-paren">(</span><em>fwhm_arc</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.reset_fwhm_arc" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset FWHM of stars in arcsec</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.reset_fwhm_arc.params.fwhm_arc"></span><strong>fwhm_arc</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.reset_fwhm_arc.params.fwhm_arc">¶</a> &#8211; FWHM of stars in arcsec</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.reset_fwhm_pix">
<code class="descname">reset_fwhm_pix</code><span class="sig-paren">(</span><em>fwhm_pix</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.reset_fwhm_pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset FWHM of stars in pixels</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.reset_fwhm_pix.params.fwhm_arc"></span><strong>fwhm_arc</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.reset_fwhm_pix.params.fwhm_arc">¶</a> &#8211; FWHM of stars in pixels</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.reset_profile_name">
<code class="descname">reset_profile_name</code><span class="sig-paren">(</span><em>profile_name</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.reset_profile_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the name of the profile used.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.reset_profile_name.params.profile_name"></span><strong>profile_name</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.reset_profile_name.params.profile_name">¶</a> &#8211; Name of the PSF profile to use for
fitting. Can be &#8216;moffat&#8217; or &#8216;gaussian&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.reset_scale">
<code class="descname">reset_scale</code><span class="sig-paren">(</span><em>scale</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.reset_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset scale attribute.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.reset_scale.params.scale"></span><strong>scale</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.reset_scale.params.scale">¶</a> &#8211; Frame scale in arcsec/pixel</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Astrometry.reset_star_list">
<code class="descname">reset_star_list</code><span class="sig-paren">(</span><em>star_list</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Astrometry.reset_star_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the list of stars</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.Astrometry.reset_star_list.params.star_list"></span><strong>star_list</strong><a class="paramlink headerlink reference internal" href="#astrometry.Astrometry.reset_star_list.params.star_list">¶</a> &#8211; An array of shape (star_nb, 2) giving the
positions in x and y of the stars.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="aligner-class">
<h2><a class="toc-backref" href="#id3">Aligner class</a><a class="headerlink" href="#aligner-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="astrometry.Aligner">
<em class="property">class </em><code class="descclassname">astrometry.</code><code class="descname">Aligner</code><span class="sig-paren">(</span><em>image1</em>, <em>image2</em>, <em>fwhm_arc</em>, <em>fov1</em>, <em>fov2</em>, <em>bin1</em>, <em>bin2</em>, <em>pix_size1</em>, <em>pix_size2</em>, <em>init_angle</em>, <em>init_dx</em>, <em>init_dy</em>, <em>sip1=None</em>, <em>sip2=None</em>, <em>saturation_threshold=60000</em>, <em>project_header=[]</em>, <em>overwrite=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Aligner" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_module.html#core.Tools" title="core.Tools"><code class="xref py py-class docutils literal"><span class="pre">core.Tools</span></code></a></p>
<p>This class is aimed to align two images of the same field of
stars and correct for optical distorsions.</p>
<p>Primarily designed to align the cube of the camera 2 onto the cube
of the camera 1 it can be used to align any other kind of images
containing stars.</p>
<dl class="method">
<dt id="astrometry.Aligner._get_guess_matrix_header">
<code class="descname">_get_guess_matrix_header</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Aligner._get_guess_matrix_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Return path to the guess matrix</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Aligner._get_guess_matrix_path">
<code class="descname">_get_guess_matrix_path</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Aligner._get_guess_matrix_path" title="Permalink to this definition">¶</a></dt>
<dd><p>Return path to the guess matrix</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Aligner.compute_alignment_parameters">
<code class="descname">compute_alignment_parameters</code><span class="sig-paren">(</span><em>correct_distorsion=False</em>, <em>star_list_path1=None</em>, <em>fwhm_arc=None</em>, <em>brute_force=True</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Aligner.compute_alignment_parameters" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the alignment coefficients that match the stars of the
frame 2 to the stars of the frame 1.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Aligner.compute_alignment_parameters.params.correct_distorsion"></span><strong>correct_distorsion</strong><a class="paramlink headerlink reference internal" href="#astrometry.Aligner.compute_alignment_parameters.params.correct_distorsion">¶</a> &#8211; (Optional) If True, a SIP is computed to
match stars from frame 2 onto the stars from frame 1. But it
needs a lot of stars to run correctly (default False).</li>
<li><span class="target" id="astrometry.Aligner.compute_alignment_parameters.params.star_list_path1"></span><strong>star_list_path1</strong><a class="paramlink headerlink reference internal" href="#astrometry.Aligner.compute_alignment_parameters.params.star_list_path1">¶</a> &#8211; (Optional) Path to a list of stars in
the image 1. If given the fwhm_arc must also be set (default None).</li>
<li><span class="target" id="astrometry.Aligner.compute_alignment_parameters.params.fwhm_arc"></span><strong>fwhm_arc</strong><a class="paramlink headerlink reference internal" href="#astrometry.Aligner.compute_alignment_parameters.params.fwhm_arc">¶</a> &#8211; (Optional) mean FWHM of the stars in
arcseconds. Must be given if star_list_path1 is not None
(default None).</li>
<li><span class="target" id="astrometry.Aligner.compute_alignment_parameters.params.brute_force"></span><strong>brute_force</strong><a class="paramlink headerlink reference internal" href="#astrometry.Aligner.compute_alignment_parameters.params.brute_force">¶</a> &#8211; (Optional) If True the first step is a
brute force guess. This is very useful if the initial
parameters are not well known (default True).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The alignement coefficients are:</p>
<ul class="last simple">
<li>dx : shift along x axis in pixels</li>
<li>dy : shift along y axis in pixels</li>
<li>dr : rotation angle between images (the center of rotation
is the center of the images of the camera 1) in degrees</li>
<li>da : tip angle between cameras (along x axis) in degrees</li>
<li>db : tilt angle between cameras (along y axis) in degrees</li>
</ul>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The process tries to find the stars detected in the camera A in the frame of the camera B. It goes through 2 steps:</p>
<ol class="last arabic simple">
<li>Rough alignment (brute force style) only looking over
dx, dy. dr is kept to its initial value (init_angle), da
and db are set to 0.</li>
<li>Fine alignment pass.</li>
</ol>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This alignment process do not work if the initial
parameters are too far from the real value. The angle must
be known within a few degrees. The shift must be known
within 4 % of the frame size (The latter can be changed
using the SIZE_COEFF constant)</p>
</div>
</dd></dl>

<dl class="method">
<dt id="astrometry.Aligner.print_alignment_coeffs">
<code class="descname">print_alignment_coeffs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Aligner.print_alignment_coeffs" title="Permalink to this definition">¶</a></dt>
<dd><p>Print the alignement coefficients.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="starsparams-class">
<h2><a class="toc-backref" href="#id4">StarsParams class</a><a class="headerlink" href="#starsparams-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="astrometry.StarsParams">
<em class="property">class </em><code class="descclassname">astrometry.</code><code class="descname">StarsParams</code><span class="sig-paren">(</span><em>star_nb=1</em>, <em>frame_nb=1</em>, <em>logfile_name=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.StarsParams" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_module.html#core.Tools" title="core.Tools"><code class="xref py py-class docutils literal"><span class="pre">core.Tools</span></code></a></p>
<p>StarsParams manage the parameters of each star in each frame of
a cube.</p>
<p>It can be accessed as a simple 3D array of shape (star_number,
frame_nb, parameter).</p>
<p>Additional methods provide an easy access to the data.</p>
<dl class="method">
<dt id="astrometry.StarsParams.convert">
<code class="descname">convert</code><span class="sig-paren">(</span><em>data</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.StarsParams.convert" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert StarsParams data to a new StarsParams instance.</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.StarsParams.get_star_list">
<code class="descname">get_star_list</code><span class="sig-paren">(</span><em>index=0</em>, <em>all_params=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.StarsParams.get_star_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an array of the positions of the stars in one frame</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.StarsParams.get_star_list.params.index"></span><strong>index</strong><a class="paramlink headerlink reference internal" href="#astrometry.StarsParams.get_star_list.params.index">¶</a> &#8211; (Optional) The index of the frame to use to
create the list of stars (default 0)</li>
<li><span class="target" id="astrometry.StarsParams.get_star_list.params.all_params"></span><strong>all_params</strong><a class="paramlink headerlink reference internal" href="#astrometry.StarsParams.get_star_list.params.all_params">¶</a> &#8211; (Optional) If True, all params are
returned. Bad params are returned as NaN values.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.StarsParams.load_stars_params">
<code class="descname">load_stars_params</code><span class="sig-paren">(</span><em>params_file_path</em>, <em>group=None</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.StarsParams.load_stars_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a file containing stars parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.StarsParams.load_stars_params.params.fit_results_path"></span><strong>fit_results_path</strong><a class="paramlink headerlink reference internal" href="#astrometry.StarsParams.load_stars_params.params.fit_results_path">¶</a> &#8211; Path to the file parameters</li>
<li><span class="target" id="astrometry.StarsParams.load_stars_params.params.silent"></span><strong>silent</strong><a class="paramlink headerlink reference internal" href="#astrometry.StarsParams.load_stars_params.params.silent">¶</a> &#8211; (Optional) If True, no message is printed
(default False).</li>
<li><span class="target" id="astrometry.StarsParams.load_stars_params.params.group"></span><strong>group</strong><a class="paramlink headerlink reference internal" href="#astrometry.StarsParams.load_stars_params.params.group">¶</a> &#8211; (Optional) Group path into the HDF5 file. If
None the group will be &#8216;/&#8217; (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.StarsParams.reset_data">
<code class="descname">reset_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.StarsParams.reset_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset StarsParams data to an empty array</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.StarsParams.save_stars_params">
<code class="descname">save_stars_params</code><span class="sig-paren">(</span><em>params_file_path</em>, <em>group=None</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.StarsParams.save_stars_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Save stars parameters in one file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.StarsParams.save_stars_params.params.params_file_path"></span><strong>params_file_path</strong><a class="paramlink headerlink reference internal" href="#astrometry.StarsParams.save_stars_params.params.params_file_path">¶</a> &#8211; Path to the parameters file</li>
<li><span class="target" id="astrometry.StarsParams.save_stars_params.params.group"></span><strong>group</strong><a class="paramlink headerlink reference internal" href="#astrometry.StarsParams.save_stars_params.params.group">¶</a> &#8211; (Optional) Group path into the HDF5 file. If
None the group will be &#8216;/&#8217; (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">if no group is given, the whole file will be
deleted if it already exists because new parameters will be
written in the root group.</p>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="psf-class">
<h2><a class="toc-backref" href="#id5">PSF class</a><a class="headerlink" href="#psf-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="astrometry.PSF">
<em class="property">class </em><code class="descclassname">astrometry.</code><code class="descname">PSF</code><span class="sig-paren">(</span><em>data_prefix='./temp/data.'</em>, <em>no_log=False</em>, <em>tuning_parameters={}</em>, <em>logfile_name=None</em>, <em>config_file_name='config.orb'</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.PSF" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="core_module.html#core.Tools" title="core.Tools"><code class="xref py py-class docutils literal"><span class="pre">core.Tools</span></code></a></p>
<p>General class of inheritance for point spread functions (PSFs)</p>
<dl class="method">
<dt id="astrometry.PSF.array2d">
<code class="descname">array2d</code><span class="sig-paren">(</span><em>nx</em>, <em>ny</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.PSF.array2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 2D profile given the size of the returned
array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.PSF.array2d.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#astrometry.PSF.array2d.params.nx">¶</a> &#8211; Length of the returned array along x axis</li>
<li><span class="target" id="astrometry.PSF.array2d.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#astrometry.PSF.array2d.params.ny">¶</a> &#8211; Length of the returned array along y axis</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.PSF.varray2d">
<code class="descname">varray2d</code><span class="sig-paren">(</span><em>nx</em>, <em>ny</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.PSF.varray2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a vectorized 2D profile given the size of the returned
array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.PSF.varray2d.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#astrometry.PSF.varray2d.params.nx">¶</a> &#8211; Length of the returned array along x axis</li>
<li><span class="target" id="astrometry.PSF.varray2d.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#astrometry.PSF.varray2d.params.ny">¶</a> &#8211; Length of the returned array along y axis</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="gaussian-class">
<h2><a class="toc-backref" href="#id6">Gaussian class</a><a class="headerlink" href="#gaussian-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="astrometry.Gaussian">
<em class="property">class </em><code class="descclassname">astrometry.</code><code class="descname">Gaussian</code><span class="sig-paren">(</span><em>params</em>, <em>logfile_name=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Gaussian" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#astrometry.PSF" title="astrometry.PSF"><code class="xref py py-class docutils literal"><span class="pre">astrometry.PSF</span></code></a></p>
<p>Class implementing the gaussian profile</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Gaussian profile used here is:
<span class="math">\(f(x,y) = H + A \times \exp(\frac{-r^2}{2 W^2})\)</span></p>
<p>and,
<span class="math">\(r = (x - dx)^2 + (y - dy)^2\)</span></p>
<p class="last">The total flux F under the 2D profile is:
<span class="math">\(F = 2 \pi A W^2\)</span></p>
</div>
<dl class="method">
<dt id="astrometry.Gaussian.array2d">
<code class="descname">array2d</code><span class="sig-paren">(</span><em>nx</em>, <em>ny</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Gaussian.array2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 2D profile given the size of the returned
array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Gaussian.array2d.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#astrometry.Gaussian.array2d.params.nx">¶</a> &#8211; Length of the returned array along x axis</li>
<li><span class="target" id="astrometry.Gaussian.array2d.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#astrometry.Gaussian.array2d.params.ny">¶</a> &#8211; Length of the returned array along y axis</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Gaussian.flux">
<code class="descname">flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Gaussian.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total flux under the 2D profile.</p>
<p>The total flux F under a 2D profile is :
<span class="math">\(F = 2 \pi A W^2\)</span></p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Under a 1d profile the flux is <span class="math">\(F = \sqrt{2\pi}A W\)</span></p>
</div>
</dd></dl>

<dl class="method">
<dt id="astrometry.Gaussian.flux_error">
<code class="descname">flux_error</code><span class="sig-paren">(</span><em>amplitude_err</em>, <em>width_err</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Gaussian.flux_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Return flux error.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Gaussian.flux_error.params.amplitude_err"></span><strong>amplitude_err</strong><a class="paramlink headerlink reference internal" href="#astrometry.Gaussian.flux_error.params.amplitude_err">¶</a> &#8211; estimation of the amplitude error</li>
<li><span class="target" id="astrometry.Gaussian.flux_error.params.width_err"></span><strong>width_err</strong><a class="paramlink headerlink reference internal" href="#astrometry.Gaussian.flux_error.params.width_err">¶</a> &#8211; estimation of the width error</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Gaussian.input_params">
<code class="descname">input_params</code><em class="property"> = ['height', 'amplitude', 'x', 'y', 'fwhm']</em><a class="headerlink" href="#astrometry.Gaussian.input_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Keys of the input parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Gaussian.params">
<code class="descname">params</code><em class="property"> = {}</em><a class="headerlink" href="#astrometry.Gaussian.params" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary containing the parameters of the profile</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="moffat-class">
<h2><a class="toc-backref" href="#id7">Moffat class</a><a class="headerlink" href="#moffat-class" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="astrometry.Moffat">
<em class="property">class </em><code class="descclassname">astrometry.</code><code class="descname">Moffat</code><span class="sig-paren">(</span><em>params</em>, <em>logfile_name=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Moffat" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#astrometry.PSF" title="astrometry.PSF"><code class="xref py py-class docutils literal"><span class="pre">astrometry.PSF</span></code></a></p>
<p>Class implementing the Moffat profile.</p>
<p>This profile is useful to fit stars on CCD arrays.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The Moffat profile has been first proposed by Moffat
(1969) A&amp;A. The exact form of the equation used has been derived
from Trujillo et al. (2001) MNRAS, 977. The PSF:</p>
<p><span class="math">\(f(x,y) = H + A \times [1+(\frac{r}{\alpha})^2]^{-\beta}\)</span></p>
<p>with,
<span class="math">\(\alpha = \frac{\text{FWHM}}{2\sqrt{2^{1/\beta} - 1}}\)</span></p>
<p>and,
<span class="math">\(r = (x - dx)^2 + (y - dy)^2\)</span></p>
<p class="last">The total flux F under the 2D profile is thus:
<span class="math">\(F = A \times \frac{\pi \alpha^2}{\beta - 1}\)</span></p>
</div>
<dl class="method">
<dt id="astrometry.Moffat.array2d">
<code class="descname">array2d</code><span class="sig-paren">(</span><em>nx</em>, <em>ny</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Moffat.array2d" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a 2D profile given the size of the returned
array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Moffat.array2d.params.nx"></span><strong>nx</strong><a class="paramlink headerlink reference internal" href="#astrometry.Moffat.array2d.params.nx">¶</a> &#8211; Length of the returned array along x axis</li>
<li><span class="target" id="astrometry.Moffat.array2d.params.ny"></span><strong>ny</strong><a class="paramlink headerlink reference internal" href="#astrometry.Moffat.array2d.params.ny">¶</a> &#8211; Length of the returned array along y axis</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="astrometry.Moffat.flux">
<code class="descname">flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Moffat.flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total flux under the 2D profile.</p>
</dd></dl>

<dl class="method">
<dt id="astrometry.Moffat.flux_error">
<code class="descname">flux_error</code><span class="sig-paren">(</span><em>amplitude_err</em>, <em>width_err</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.Moffat.flux_error" title="Permalink to this definition">¶</a></dt>
<dd><p>Return flux error.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.Moffat.flux_error.params.amplitude_err"></span><strong>amplitude_err</strong><a class="paramlink headerlink reference internal" href="#astrometry.Moffat.flux_error.params.amplitude_err">¶</a> &#8211; estimation of the amplitude error</li>
<li><span class="target" id="astrometry.Moffat.flux_error.params.width_err"></span><strong>width_err</strong><a class="paramlink headerlink reference internal" href="#astrometry.Moffat.flux_error.params.width_err">¶</a> &#8211; estimation of the width error</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Not implemented yet!</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Moffat.input_params">
<code class="descname">input_params</code><em class="property"> = ['height', 'amplitude', 'x', 'y', 'fwhm', 'beta']</em><a class="headerlink" href="#astrometry.Moffat.input_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Keys of the input parameters</p>
</dd></dl>

<dl class="attribute">
<dt id="astrometry.Moffat.params">
<code class="descname">params</code><em class="property"> = {}</em><a class="headerlink" href="#astrometry.Moffat.params" title="Permalink to this definition">¶</a></dt>
<dd><p>dictionary containing the parameters of the profile</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="astrometry-functions">
<h2><a class="toc-backref" href="#id8">Astrometry functions</a><a class="headerlink" href="#astrometry-functions" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="astrometry.mag">
<code class="descclassname">astrometry.</code><code class="descname">mag</code><span class="sig-paren">(</span><em>flux</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.mag" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>Return the instrumental magnitude of a given flux (magnitude 0</dt>
<dd>is set to 1 e-)</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.mag.params.flux"></span><strong>flux</strong><a class="paramlink headerlink reference internal" href="#astrometry.mag.params.flux">¶</a> &#8211; Flux in e-</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="astrometry.guess">
<code class="descclassname">astrometry.</code><code class="descname">guess</code><span class="sig-paren">(</span><em>star_box</em>, <em>pos=None</em>, <em>height=None</em>, <em>precise_pos=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.guess" title="Permalink to this definition">¶</a></dt>
<dd><p>Return an estimation of the star parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="astrometry.guess.params.star_box"></span><strong>star_box</strong><a class="paramlink headerlink reference internal" href="#astrometry.guess.params.star_box">¶</a> &#8211; Sub-part of an image surrounding a star. The
center of the star must be placed near the center of the
box. The dimensions of the box must be greater than 3 times
the FWHM of the star.</li>
<li><span class="target" id="astrometry.guess.params.pos"></span><strong>pos</strong><a class="paramlink headerlink reference internal" href="#astrometry.guess.params.pos">¶</a> &#8211; (Optional) Position guess as a tuple (x,y). Used to
estimate amplitude (default None).</li>
<li><span class="target" id="astrometry.guess.params.height"></span><strong>height</strong><a class="paramlink headerlink reference internal" href="#astrometry.guess.params.height">¶</a> &#8211; (Optional) Guess of the background level. Used to
estimate amplitude (default None).</li>
<li><span class="target" id="astrometry.guess.params.precise_pos"></span><strong>precise_pos</strong><a class="paramlink headerlink reference internal" href="#astrometry.guess.params.precise_pos">¶</a> &#8211; (Optional) If True, position is estimated from
the marginal distribution of the PSF. Return a far better
estimation if and only if the star is well centered in the box,
i.e. if and only if the position of the star is already
known. This can lead to errors when trying to find the star in
the box, in this case precise_pos must be set to False (default
False).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">[height,amplitude,x,y,width]</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="astrometry.fit_star">
<code class="descclassname">astrometry.</code><code class="descname">fit_star</code><span class="sig-paren">(</span><em>star_box</em>, <em>profile_name='gaussian'</em>, <em>fwhm_pix=None</em>, <em>amp=None</em>, <em>beta=3.5</em>, <em>height=None</em>, <em>pos=None</em>, <em>fix_height=False</em>, <em>fix_amp=False</em>, <em>fix_beta=True</em>, <em>fix_fwhm=False</em>, <em>fix_pos=False</em>, <em>fit_tol=0.001</em>, <em>check=True</em>, <em>fwhm_min=0.5</em>, <em>check_reject=False</em>, <em>ron=10.0</em>, <em>dcl=0.0</em>, <em>estimate_local_noise=True</em>, <em>precise_guess=False</em>, <em>saturation=None</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.fit_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a single star</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.fit_star.params.star_box"></span><strong>star_box</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.star_box">¶</a> &#8211; The box where the star has to be fitted.</li>
<li><span class="target" id="astrometry.fit_star.params.profile_name"></span><strong>profile_name</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.profile_name">¶</a> &#8211; (Optional) Name of the PSF profile to use to
fit stars. May be &#8216;gaussian&#8217; or &#8216;moffat&#8217; (default &#8216;gaussian&#8217;).</li>
<li><span class="target" id="astrometry.fit_star.params.amp"></span><strong>amp</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.amp">¶</a> &#8211; (Optional) Amplitude guess, replace the value of the
automatic estimation (default None).</li>
<li><span class="target" id="astrometry.fit_star.params.fwhm_pix"></span><strong>fwhm_pix</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fwhm_pix">¶</a> &#8211; (Optional) Estimate of the FWHM in pixels. If
None given FWHM is estimated to half the box size (default
None).</li>
<li><span class="target" id="astrometry.fit_star.params.beta"></span><strong>beta</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.beta">¶</a> &#8211; (Optional) Beta parameter of the moffat psf. Used
only if the fitted profile is a Moffat psf (default 3.5).</li>
<li><span class="target" id="astrometry.fit_star.params.height"></span><strong>height</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.height">¶</a> &#8211; (Optional) Height guess, replace the value of the
automatic estimation (default None).</li>
<li><span class="target" id="astrometry.fit_star.params.pos"></span><strong>pos</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.pos">¶</a> &#8211; (Optional) Position guess as a tuple (x,y), replace
the value of the automatic estimation (default None).</li>
<li><span class="target" id="astrometry.fit_star.params.fix_amp"></span><strong>fix_amp</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fix_amp">¶</a> &#8211; (Optional) Fix amplitude parameter to its
estimation (default False)</li>
<li><span class="target" id="astrometry.fit_star.params.fix_height"></span><strong>fix_height</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fix_height">¶</a> &#8211; (Optional) Fix height parameter to its
estimation (default False)</li>
<li><span class="target" id="astrometry.fit_star.params.fix_beta"></span><strong>fix_beta</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fix_beta">¶</a> &#8211; (Optional) Fix beta to the given value (default
True).</li>
<li><span class="target" id="astrometry.fit_star.params.fix_fwhm"></span><strong>fix_fwhm</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fix_fwhm">¶</a> &#8211; (Optional) Fix FWHM to its estimation (default
False).</li>
<li><span class="target" id="astrometry.fit_star.params.fix_pos"></span><strong>fix_pos</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fix_pos">¶</a> &#8211; (Optional) Fix position parameters (x,y) at their
estimated value (default False).</li>
<li><span class="target" id="astrometry.fit_star.params.fit_tol"></span><strong>fit_tol</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fit_tol">¶</a> &#8211; (Optional) Tolerance on the paramaters fit (the
lower the better but the longer too) (default 1e-2).</li>
<li><span class="target" id="astrometry.fit_star.params.check"></span><strong>check</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.check">¶</a> &#8211; (Optional) If True, check fit results for oddities
(default True).</li>
<li><span class="target" id="astrometry.fit_star.params.fwhm_min"></span><strong>fwhm_min</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.fwhm_min">¶</a> &#8211; (Optional) Minimum valid FWHM [in pixel] of the
fitted star (default 0.5)</li>
<li><span class="target" id="astrometry.fit_star.params.check_reject"></span><strong>check_reject</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.check_reject">¶</a> &#8211; (Optional) [Debug] If True, print the reason
why a fit is rejected (default False).</li>
<li><span class="target" id="astrometry.fit_star.params.ron"></span><strong>ron</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.ron">¶</a> &#8211; (Optional) Readout noise in ADU/pixel (default
10.). estimate_local_noise must be set to False for this noise
to be taken into account.</li>
<li><span class="target" id="astrometry.fit_star.params.dcl"></span><strong>dcl</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.dcl">¶</a> &#8211; (Optional) Dark current level in ADU/pixel (default
0.). estimate_local_noise must be set to False for this noise to
be taken into account.</li>
<li><span class="target" id="astrometry.fit_star.params.estimate_local_noise"></span><strong>estimate_local_noise</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.estimate_local_noise">¶</a> &#8211; (Optional) If True, the level of
noise is computed from the background pixels around the
stars. ron and dcl are thus not used (default True).</li>
<li><span class="target" id="astrometry.fit_star.params.precise_guess"></span><strong>precise_guess</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.precise_guess">¶</a> &#8211; (Optional) If True, the fit guess will be
more precise but this can lead to errors if the stars positions
are not already well known (default False).</li>
<li><span class="target" id="astrometry.fit_star.params.saturation"></span><strong>saturation</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_star.params.saturation">¶</a> &#8211; (Optional) If not None, all pixels above the
saturation level are removed from the fit (default None).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="astrometry.aperture_photometry">
<code class="descclassname">astrometry.</code><code class="descname">aperture_photometry</code><span class="sig-paren">(</span><em>star_box</em>, <em>fwhm_guess</em>, <em>background_guess=None</em>, <em>background_guess_err=0.0</em>, <em>aper_coeff=3.0</em>, <em>warn=True</em>, <em>x_guess=None</em>, <em>y_guess=None</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.aperture_photometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the aperture photometry of a star centered in a star box.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="astrometry.aperture_photometry.params.star_box"></span><strong>star_box</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.star_box">¶</a> &#8211; Star box</li>
<li><span class="target" id="astrometry.aperture_photometry.params.fwhm_guess"></span><strong>fwhm_guess</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.fwhm_guess">¶</a> &#8211; Guessed FWHM. Used to get the aperture radius.</li>
<li><span class="target" id="astrometry.aperture_photometry.params.background_guess"></span><strong>background_guess</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.background_guess">¶</a> &#8211; (Optional) If not None, this guess is
used instead of the background determination in an annulus
around the star (default None).</li>
<li><span class="target" id="astrometry.aperture_photometry.params.background_guess_err"></span><strong>background_guess_err</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.background_guess_err">¶</a> &#8211; (Optional) Error on the background
guess. Used to compute the aperture photometry error (default 0.).</li>
<li><span class="target" id="astrometry.aperture_photometry.params.aper_coeff"></span><strong>aper_coeff</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.aper_coeff">¶</a> &#8211; (Optional) Aperture coefficient. The aperture
radius is Rap = aper_coeff * FWHM. Better when between 1.5 to
reduce the variation of the collected photons with varying FWHM
and 3. to account for the flux in the wings (default 3., better
for star with a high SNR).</li>
<li><span class="target" id="astrometry.aperture_photometry.params.warn"></span><strong>warn</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.warn">¶</a> &#8211; If True, print a warning when the background cannot
be well estimated (default True).</li>
<li><span class="target" id="astrometry.aperture_photometry.params.x_guess"></span><strong>x_guess</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.x_guess">¶</a> &#8211; (Optional) position of the star along x axis. If
None, star is assumed to lie at the very center of the frame
(default None).</li>
<li><span class="target" id="astrometry.aperture_photometry.params.y_guess"></span><strong>y_guess</strong><a class="paramlink headerlink reference internal" href="#astrometry.aperture_photometry.params.y_guess">¶</a> &#8211; (Optional) position of the star along y axis. If
None, star is assumed to lie at the very center of the frame
(default None).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A Tuple (flux, flux_error, aperture surface,
bad_estimation_flag). If the estimation is bad,
bad_estimation_flat is set to 1, else it is set to 0.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Best aperture for maximum S/N: 1. FWHM (Howell 1989,
Howell 1992). But that works only when the PSF is well sampled
which is not always the case so a higher aperture coefficient
may be better. More over, to get exact photometry the result
must be corrected by aperture growth curve for the &#8216;missing
light&#8217;. A coefficient of 1.27 FWHM corresponds to 3 sigma and
collects more than 99% of the light. A coefficient of 1.5 reduce
the variations of the proportion of collected photons with the
FWHM.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Best radius for sky background annulus is determined
from this rule of thumb: The number of pixels to estimate the
background must be al least 3 times the number of pixel in the
aperture (Merline &amp; Howell 1995). Choosing the aperture radius
coefficient(Cap) as Rap = Cap * FWHM and the inner radius
coefficient (Cin) as Rin = Cin * FWHM, gives the outer radius
coefficient (Cout): Cout = sqrt(3*Cap^2 + Cin^2)</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The star MUST be at the center (+/- a pixel) of the
star box.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="astrometry.fit_stars_in_frame">
<code class="descclassname">astrometry.</code><code class="descname">fit_stars_in_frame</code><span class="sig-paren">(</span><em>frame</em>, <em>star_list</em>, <em>box_size</em>, <em>profile_name='gaussian'</em>, <em>scale=None</em>, <em>fwhm_pix=None</em>, <em>beta=3.5</em>, <em>fit_tol=0.01</em>, <em>fwhm_min=0.5</em>, <em>fix_height=None</em>, <em>fix_aperture_fwhm_pix=None</em>, <em>fix_beta=True</em>, <em>fix_fwhm=False</em>, <em>readout_noise=10.0</em>, <em>dark_current_level=0.0</em>, <em>local_background=True</em>, <em>no_aperture_photometry=False</em>, <em>precise_guess=False</em>, <em>aper_coeff=3.0</em>, <em>blur=False</em>, <em>no_fit=False</em>, <em>estimate_local_noise=True</em>, <em>multi_fit=False</em>, <em>enable_zoom=False</em>, <em>enable_rotation=False</em>, <em>saturation=None</em>, <em>fix_pos=False</em>, <em>nozero=False</em>, <em>silent=True</em>, <em>sip=None</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.fit_stars_in_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit stars in a frame.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>2 fitting modes are possible:</p>
<ul class="last simple">
<li>Individual fit mode [multi_fit=False]: Stars are all fit
independantly.</li>
<li>Multi fit mode [multi_fit=True]: Stars are fitted all together
considering that the position pattern is well known, the same
shift in x and y will be applied. Optionally the pattern can be
rotated and zoomed. The FWHM is also considered to be the
same. This option is far more robust and precise for alignment
purpose.</li>
</ul>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="astrometry.fit_stars_in_frame.params.frame"></span><strong>frame</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.frame">¶</a> &#8211; The frame containing the stars to fit.</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.star_list"></span><strong>star_list</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.star_list">¶</a> &#8211; A list of star positions as an array of shape
(star_nb, 2)</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.box_size"></span><strong>box_size</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.box_size">¶</a> &#8211; The size of the box created around a star to fit
its parameter.</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.profile_name"></span><strong>profile_name</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.profile_name">¶</a> &#8211; (Optional) Name of the PSF profile to use to
fit stars. May be &#8216;gaussian&#8217; or &#8216;moffat&#8217; (default &#8216;gaussian&#8217;).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fwhm_pix"></span><strong>fwhm_pix</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fwhm_pix">¶</a> &#8211; (Optional) Estimate of the FWHM in pixels. If
None given FWHM is estimated to half the box size (default
None).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.scale"></span><strong>scale</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.scale">¶</a> &#8211; (Optional) Scale of the frame in arcsec/pixel. If
given the fwhm in arcseconds is also computed (keyword:
&#8216;fwhm_arc&#8217;) with the fit parameters (default None).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.beta"></span><strong>beta</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.beta">¶</a> &#8211; (Optional) Beta parameter of the moffat psf. Used
only if the fitted profile is a Moffat psf (default 3.5).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fix_height"></span><strong>fix_height</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fix_height">¶</a> &#8211; (Optional) Fix height parameter to its
estimation. If None, set by default to True in individual fit
mode [multi_fit=False] and False in multi fit mode
[multi_fit=True] (default None).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fix_beta"></span><strong>fix_beta</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fix_beta">¶</a> &#8211; (Optional) Fix beta to the given value (default
True).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fix_fwhm"></span><strong>fix_fwhm</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fix_fwhm">¶</a> &#8211; (Optional) Fix FWHM to the given value or the
estimated value (default False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fix_pos"></span><strong>fix_pos</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fix_pos">¶</a> &#8211; (Optional) Fix x,y positions of the stars to the
given value.</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fit_tol"></span><strong>fit_tol</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fit_tol">¶</a> &#8211; (Optional) Tolerance on the paramaters fit (the
lower the better but the longer too) (default 1e-2).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.nozero"></span><strong>nozero</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.nozero">¶</a> &#8211; (Optional) If True do not fit any star which box
(the pixels around it) contains a zero. Valid only in individual
fit mode [multi_fit=False] (default False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fwhm_min"></span><strong>fwhm_min</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fwhm_min">¶</a> &#8211; (Optional) Minimum valid FWHM of the fitted star
(default 0.5)</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.silent"></span><strong>silent</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.silent">¶</a> &#8211; (Optional) If True no messages are printed (default
True).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.local_background"></span><strong>local_background</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.local_background">¶</a> &#8211; (Optional) If True, height is estimated
localy, i.e. around the star. If False, the sky background is
determined in the whole frame. In individual fit mode
[multi_fit=False] height will be the same for all the stars, and
the fix_height option is thus automatically set to True. In
multi fit mode [multi_fit=True] height is considered as a
covarying parameter for all the stars but it won&#8217;t be fixed
(default True).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.fix_aperture_fwhm_pix"></span><strong>fix_aperture_fwhm_pix</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.fix_aperture_fwhm_pix">¶</a> &#8211; (Optional) If a positive float. FWHM
used to scale aperture size is not computed from the mean FWHM
in the frame but fixed to the given float (default None).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.no_aperture_photometry"></span><strong>no_aperture_photometry</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.no_aperture_photometry">¶</a> &#8211; (Optional) If True, aperture
photometry will not be done after profile fitting (default
False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.precise_guess"></span><strong>precise_guess</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.precise_guess">¶</a> &#8211; (Optional) If True, the fit guess will be
more precise but this can lead to errors if the stars positions
are not already well known. Valid only in individual fit mode
[multi_fit=False] (default False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.readout_noise"></span><strong>readout_noise</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.readout_noise">¶</a> &#8211; (Optional) Readout noise in ADU/pixel (can
be computed from bias frames: std(master_bias_frame)) (default
10.)</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.dark_current_level"></span><strong>dark_current_level</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.dark_current_level">¶</a> &#8211; (Optional) Dark current level in
ADU/pixel (can be computed from dark frames:
median(master_dark_frame)) (default 0.)</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.aper_coeff"></span><strong>aper_coeff</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.aper_coeff">¶</a> &#8211; (Optional) Aperture coefficient. The aperture
radius is Rap = aper_coeff * FWHM. Better when between 1.5 to
reduce the variation of the collected photons with varying FWHM
and 3. to account for the flux in the wings (default 3., better
for star with a high SNR).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.blur"></span><strong>blur</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.blur">¶</a> &#8211; (Optional) If True, blur frame (low pass filtering)
before fitting stars. It can be used to enhance the quality of
the fitted flux of undersampled data. Note that the error on
star position can be greater on blurred frame. This option must
not be used for alignment purpose (default False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.no_fit"></span><strong>no_fit</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.no_fit">¶</a> &#8211; (Optional) If True, no fit is done. Only the
aperture photometry. Star positions in the star list must thus
be precise (default False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.multi_fit"></span><strong>multi_fit</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.multi_fit">¶</a> &#8211; (Optional) If True all stars are fitted at the
same time. More robust for alignment purpose. The difference of
position between the stars in the star list must be precisely
known because the overall shift only is estimated (default
False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.enable_zoom"></span><strong>enable_zoom</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.enable_zoom">¶</a> &#8211; (Optional) If True, the stars position pattern
can be zoomed to better adjust it to the real frame. Valid only
in multi fit mode [multi_fit=True] (default False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.enable_rotation"></span><strong>enable_rotation</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.enable_rotation">¶</a> &#8211; (Optional) If True, the stars position
pattern can be rotated to better adjust it to the real frame
Valid only in multi fit mode [multi_fit=True] (default False).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.estimate_local_noise"></span><strong>estimate_local_noise</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.estimate_local_noise">¶</a> &#8211; (Optional) If True, the level of
noise is computed from the background pixels around the
stars. readout_noise and dark_current_level are thus not used
(default True).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.saturation"></span><strong>saturation</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.saturation">¶</a> &#8211; (Optional) If not None, all pixels above the
saturation level are removed from the fit (default None).</li>
<li><span class="target" id="astrometry.fit_stars_in_frame.params.sip"></span><strong>sip</strong><a class="paramlink headerlink reference internal" href="#astrometry.fit_stars_in_frame.params.sip">¶</a> &#8211; (Optional) A pywcs.WCS instance containing SIP
distorsion correction (default None).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Parameters of a 2D fit of the stars positions.</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#astrometry.Astrometry.load_star_list" title="astrometry.Astrometry.load_star_list"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.Astrometry.load_star_list()</span></code></a> to load
a predefined list of stars or
<a class="reference internal" href="#astrometry.Astrometry.detect_stars" title="astrometry.Astrometry.detect_stars"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.Astrometry.detect_stars()</span></code></a> to automatically
create it.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#astrometry.fit_star" title="astrometry.fit_star"><code class="xref py py-meth docutils literal"><span class="pre">astrometry.fit_star()</span></code></a> and
<a class="reference internal" href="cutils_module.html#cutils.multi_fit_stars" title="cutils.multi_fit_stars"><code class="xref py py-meth docutils literal"><span class="pre">cutils.multi_fit_stars()</span></code></a></p>
</div>
</dd></dl>

<dl class="function">
<dt id="astrometry.load_star_list">
<code class="descclassname">astrometry.</code><code class="descname">load_star_list</code><span class="sig-paren">(</span><em>star_list_path</em>, <em>silent=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.load_star_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Load a list of stars coordinates</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.load_star_list.params.star_list_path"></span><strong>star_list_path</strong><a class="paramlink headerlink reference internal" href="#astrometry.load_star_list.params.star_list_path">¶</a> &#8211; The path to the star list file.</li>
<li><span class="target" id="astrometry.load_star_list.params.silent"></span><strong>silent</strong><a class="paramlink headerlink reference internal" href="#astrometry.load_star_list.params.silent">¶</a> &#8211; (Optional) If True no message is printed (default
False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>A list of stars is a list of star coordinates (x and
y). Each set of coordinates is separated by a line
break. There must not be any blank line or comments.</p>
<p>For example:</p>
<div class="last highlight-python"><div class="highlight"><pre>221.994164678 62.8374036151
135.052291354 274.848787038
186.478298303 11.8162949818
362.642981933 323.083868198
193.546595814 321.017948051
</pre></div>
</div>
</div>
<p>The star list can be created using DS9
(<a class="reference external" href="http://hea-www.harvard.edu/RD/ds9/site/Home.html">http://hea-www.harvard.edu/RD/ds9/site/Home.html</a>) on the
first image of the sequence :</p>
<blockquote>
<div><ol class="arabic simple">
<li>Select more than 3 stars with the circular tool (the
more you select, the better will be the alignment)</li>
<li>Save the regions you have created with the options:<ul>
<li>Format = &#8216;XY&#8217;</li>
<li>Coordinate system = &#8216;Image&#8217;</li>
</ul>
</li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="astrometry.get_profile">
<code class="descclassname">astrometry.</code><code class="descname">get_profile</code><span class="sig-paren">(</span><em>profile_name</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.get_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the PSF profile class corresponding to the given profile name.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><span class="target" id="astrometry.get_profile.params.name"></span><strong>name</strong><a class="paramlink headerlink reference internal" href="#astrometry.get_profile.params.name">¶</a> (<em>profile</em>) &#8211; The name of the PSF profile. Must be &#8216;moffat&#8217;
or &#8216;gaussian&#8217;.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="astrometry.radial_profile">
<code class="descclassname">astrometry.</code><code class="descname">radial_profile</code><span class="sig-paren">(</span><em>a</em>, <em>xc</em>, <em>yc</em>, <em>rmax</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.radial_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the averaged radial profile on a region of a 2D array.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><span class="target" id="astrometry.radial_profile.params.a"></span><strong>a</strong><a class="paramlink headerlink reference internal" href="#astrometry.radial_profile.params.a">¶</a> &#8211; A 2D array</li>
<li><span class="target" id="astrometry.radial_profile.params.xc"></span><strong>xc</strong><a class="paramlink headerlink reference internal" href="#astrometry.radial_profile.params.xc">¶</a> &#8211; Center of the profile along x axis</li>
<li><span class="target" id="astrometry.radial_profile.params.yc"></span><strong>yc</strong><a class="paramlink headerlink reference internal" href="#astrometry.radial_profile.params.yc">¶</a> &#8211; Center of the profile along y axis</li>
<li><span class="target" id="astrometry.radial_profile.params.rmax"></span><strong>rmax</strong><a class="paramlink headerlink reference internal" href="#astrometry.radial_profile.params.rmax">¶</a> &#8211; Radius of the profile</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">(R axis, V axis). A tuple of 2 vectors giving the radius
axis and the corresponding values axis.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="astrometry.sky_background_level">
<code class="descclassname">astrometry.</code><code class="descname">sky_background_level</code><span class="sig-paren">(</span><em>im</em>, <em>smooth_coeff=0.1</em>, <em>return_mode=False</em>, <em>bins=25</em>, <em>return_error=False</em><span class="sig-paren">)</span><a class="headerlink" href="#astrometry.sky_background_level" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the level of the sky background based on the maximum of
the histogram of the pixels distribution in the image.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><span class="target" id="astrometry.sky_background_level.params.im"></span><strong>im</strong><a class="paramlink headerlink reference internal" href="#astrometry.sky_background_level.params.im">¶</a> &#8211; Image.</li>
<li><span class="target" id="astrometry.sky_background_level.params.smooth_coeff"></span><strong>smooth_coeff</strong><a class="paramlink headerlink reference internal" href="#astrometry.sky_background_level.params.smooth_coeff">¶</a> &#8211; (Optional) the smoothing degree, i.e. the
number of smoothing points is defined by smooth_coeff *
size(histogram) (default 0.05). If smooth_coeff &lt;= 0. no
smoothing is applied.</li>
<li><span class="target" id="astrometry.sky_background_level.params.return_mode"></span><strong>return_mode</strong><a class="paramlink headerlink reference internal" href="#astrometry.sky_background_level.params.return_mode">¶</a> &#8211; (Optional) If True the returned value is the
mode (an entire value for a distribution of integers). If False,
return the mean of a sigmacut realized around the mode (a
fractional value, generally more precise).</li>
<li><span class="target" id="astrometry.sky_background_level.params.bins"></span><strong>bins</strong><a class="paramlink headerlink reference internal" href="#astrometry.sky_background_level.params.bins">¶</a> &#8211; (Optional) Number of bins for the histogram (default
20).</li>
<li><span class="target" id="astrometry.sky_background_level.params.return_error"></span><strong>return_error</strong><a class="paramlink headerlink reference internal" href="#astrometry.sky_background_level.params.return_error">¶</a> &#8211; (Optional) If True, the error on the
estimation is returned (default False).</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="visual_module.html" class="btn btn-neutral float-right" title="Visual module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="cutils_module.html" class="btn btn-neutral" title="CUtils module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Thomas Martin (thomas.martin.1@ulaval.ca).
    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.4.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>